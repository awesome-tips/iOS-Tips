# 2018.05

åœ¨ Cycript å’Œ LLDB ä¸­ä½¿ç”¨ç§æœ‰çš„æ–¹æ³•è°ƒè¯• iOS
--------
**ä½œè€…**: [Lefe_x](https://weibo.com/u/5953150140)

ä¸‹é¢è¿™äº›æ–¹æ³•å¯¹äºä½¿ç”¨ `Cycript` å’Œ `LLDB` è°ƒè¯•ç¬¬ä¸‰æ–¹åº”ç”¨éå¸¸æ–¹ä¾¿ï¼Œæ¯”å¦‚æƒ³æ‰“å°å½“å‰çš„è§†å›¾å±‚çº§ç»“æ„ï¼Œæ‰“å°æŸä¸ªç±»çš„å±æ€§ï¼Œæ–¹æ³•ï¼Œæ‰¾åˆ°å½“å‰æ˜¾ç¤ºçš„ `ViewController` ç­‰ã€‚å½“ç„¶ï¼Œåœ¨éé€†å‘çš„ç¯å¢ƒä¸­ï¼Œå¯ä»¥ä½¿ç”¨ `performSelector:` æ‰§è¡Œï¼Œå¯ä»¥æŸ¥çœ‹åˆ°åŒæ ·çš„æ•ˆæœï¼Œä¸‹é¢çš„ä¾‹å­é€šè¿‡ `performSelector:` æ–¹æ³•è·å–ã€‚

- `recursiveDescription`ï¼šæ‰“å°æŸä¸ªè§†å›¾çš„å±‚çº§å…³ç³»ï¼›

```
<UIWindow: 0x7fdc86411aa0; frame = (0 0; 375 812); gestureRecognizers = <NSArray: 0x600000248a60>; layer = <UIWindowLayer: 0x600000239e80>>
```

- `_printHierarchy`ï¼šç›´æ¥è·å–å½“å‰æ˜¾ç¤ºçš„ `ViewController`ï¼Œä¸å¿…ä½¿ç”¨ `[view nextResponder]` è·å–å½“å‰æ˜¾ç¤ºçš„ viewControllerï¼›

```
<ViewController 0x7fdc86411270>, state: appeared, view: <UIView 0x7fdc867085e0>
```

- `_autolayoutTrace`ï¼šæ˜¯ recursiveDescription çš„ç²¾ç®€ç‰ˆï¼Œå¿½ç•¥äº†å…³äº View çš„æè¿°ä¿¡æ¯ï¼›

```
UIWindow:0x7fdc86411aa0
|   UIView:0x7fdc867085e0
```

- `_ivarDescription`ï¼šæ‰“å°æŸä¸ªå®ä¾‹çš„æ‰€æœ‰å˜é‡åå’Œå€¼ï¼›

```
<Lefex: 0x604000005a80>:
in Lefex:
	_name (NSString*): @"wsy"
in NSObject:
	isa (Class): Lefex (isa, 0x10cde9038)
```

- `_methodDescription`ï¼šæ‰“å°æŸä¸ªç±»çš„æ‰€æœ‰å±æ€§ï¼Œå®ä¾‹æ–¹æ³•ï¼Œç±»æ–¹æ³•ã€‚

```
<Lefex: 0x604000005a80>:
in Lefex:
	Class Methods:
		+ (id) trueName; (0x10cde6590)
	Properties:
		@property (copy, nonatomic) NSString* name;  (@synthesize name = _name;)
	Instance Methods:
		- (void) changeName; (0x10cde6580)
		- (void) .cxx_destruct; (0x10cde6620)
		- (id) name; (0x10cde65b0)
		- (void) setName:(id)arg1; (0x10cde65e0)
in NSObject:
	Class Methods:
	çœç•¥......
```

[å‚è€ƒ](http://iosre.com/t/powerful-private-methods-for-debugging-in-cycript-lldb/3414)





æ›¿æ¢ç³»ç»ŸéŸ³é‡æç¤º
--------
**ä½œè€…**: [Vong_HUST](https://weibo.com/VongLo)

ç›¸ä¿¡å¹³æ—¶å¤§å®¶åœ¨ç”¨ iPhone çœ‹è§†é¢‘è°ƒèŠ‚éŸ³é‡æ—¶ï¼Œæ€»ä¼šè¢«ç³»ç»Ÿçš„éŸ³é‡æç¤ºæ‰€æ‰“æ‰°ï¼Œå› ä¸ºå®ƒä¼šé®ä½ä¸€éƒ¨åˆ†å†…å®¹ã€‚æ‰€ä»¥å¾ˆå¤šè§†é¢‘åº”ç”¨éƒ½ä½¿ç”¨è‡ªå®šä¹‰éŸ³é‡è§†å›¾çš„æ–¹å¼æ¥æ›¿ä»£ç³»ç»Ÿçš„éŸ³é¢‘ã€‚æ¯”å¦‚ä¸‹é¢ä¸‰å¼ æˆªå›¾ï¼Œåˆ†åˆ«æ¥è‡ª Instagramã€å“”å“©å“”å“©ã€å³åˆ»

![](https://github.com/iOS-Tips/iOS-tech-set/blob/master/images/2018/05/2-1.png?raw=true)

å…¶å®è¦å®ç°è¿™ä¸ªï¼Œä¸»è¦æ˜¯å®ç°ä¸‹é¢å‡ ä¸ªè¦ç‚¹

- æ¿€æ´» AudioSession
- åˆ›å»ºä¸€ä¸ª MPVolumeViewï¼Œå¹¶å°†å…¶æ·»åŠ åˆ°å½“å‰å¯è§çš„è§†å›¾å±‚çº§å½“ä¸­ï¼ŒåŒæ—¶å°†å…¶ frame è®¾ç½®åˆ°ä¸å¯è§åŒºåŸŸ
- ç›‘å¬éŸ³é‡æŒ‰é’®è§¦å‘äº‹ä»¶ï¼Œæ”¹å˜éŸ³é‡æç¤ºï¼ˆç›‘å¬æ–¹å¼æœ‰ä¸¤ç§ï¼šKVOã€NSNotificationï¼‰

ä»£ç åˆ†åˆ«ä¸º

```objc
// KVO
- (void)dealloc {
    [[AVAudioSession sharedInstance] removeObserver:self
                                         forKeyPath:NSStringFromSelector(@selector(outputVolume))];
}

- (void)addObserver {
    [[AVAudioSession sharedInstance] addObserver:self
                                      forKeyPath:NSStringFromSelector(@selector(outputVolume))
                                         options:NSKeyValueObservingOptionNew
                                         context:nil];
}

- (void)observeValueForKeyPath:(NSString *)keyPath
                      ofObject:(id)object
                        change:(NSDictionary<NSKeyValueChangeKey,id> *)change
                       context:(void *)context {
    if ([change isKindOfClass:[NSDictionary class]]) {
        NSNumber *volumeNum = change[@"new"];
        if (volumeNum) {
            [self volumeDidChange:[volumeNum floatValue]];
        }
    }
}

- (void)volumeDidChange:(CGFloat)volume {
    // æ˜¾ç¤ºè‡ªå®šä¹‰éŸ³é‡æç¤º
}

```

```objc
// Notification
static NSNotificationName const kSystemVolumeDidChangeNotification = @"AVSystemController_SystemVolumeDidChangeNotification";

- (void)dealloc {
    [[NSNotificationCenter defaultCenter] removeObserver:self];
}

- (void)addObserver {
    [[NSNotificationCenter defaultCenter] addObserver:self
                                             selector:@selector(volumeDidChange:)
                                                 name:kSystemVolumeDidChangeNotification
                                               object:nil];
}

- (void)volumeDidChange:(NSNotification *)notification {
    NSString *category = notification.userInfo[@"AVSystemController_AudioCategoryNotificationParameter"];
    NSString *changeReason = notification.userInfo[@"AVSystemController_AudioVolumeChangeReasonNotificationParameter"];
    if (![category isEqualToString:@"Audio/Video"] || ![changeReason isEqualToString:@"ExplicitVolumeChange"]) {
        return;
    }

    CGFloat volume = [[notification userInfo][@"AVSystemController_AudioVolumeNotificationParameter"] floatValue];
    // æ˜¾ç¤ºè‡ªå®šä¹‰éŸ³é‡æç¤º
}
```


- KVO åœ¨éŸ³é‡è°ƒèŠ‚è‡³æœ€å¤§/æœ€å°æ—¶ï¼Œè¿™ä¸ªæ—¶å€™å†è°ƒå¤§/è°ƒå°éŸ³é‡ï¼Œç”±äº `outputVolume` çš„å€¼ä¸å˜ï¼Œæ‰€ä»¥ä¸ä¼šè§¦å‘ `KVO`ï¼Œä¹Ÿå°±æ— æ³•å±•ç¤ºè‡ªå®šä¹‰éŸ³é‡è§†å›¾ï¼Œ
- ç›‘å¬ç³»ç»Ÿç§æœ‰(æœªå…¬å¼€çš„)é€šçŸ¥ï¼Œåå­—æ˜¯ `AVSystemController_SystemVolumeDidChangeNotification`ï¼Œè¿™ä¸ªç›‘å¬ä¸ä¼šå—åˆ°æœ€å¤§/æœ€å°éŸ³é‡æ—¶ï¼Œè°ƒå¤§/è°ƒå°éŸ³é‡çš„å½±å“ï¼Œåªè¦éŸ³é‡é”®æŒ‰ä¸‹ï¼Œå§‹ç»ˆéƒ½ä¼šè§¦å‘ã€‚ä½†æ˜¯è¿™ä¸ªé€šçŸ¥ç”±äºæ˜¯ç§æœ‰çš„ï¼Œå¯èƒ½å­˜åœ¨è¢«æ‹’é£é™©ï¼Œè€Œä¸”å°†æ¥ç³»ç»Ÿç‰ˆæœ¬è¯¥é€šçŸ¥åå­—å‘ç”Ÿæ”¹å˜ï¼Œç”±äºæ˜¯ç¡¬ç¼–ç è€Œä¸åƒå…¶å®ƒç³»ç»Ÿé€šçŸ¥ä½¿ç”¨çš„æ˜¯å¸¸é‡ï¼Œä¼šå¯¼è‡´ç›‘å¬ä¸åˆ°çš„é—®é¢˜ã€‚

å‚è€ƒé“¾æ¥ï¼š[VolumeBar](https://github.com/gizmosachin/VolumeBar)

ä½ çš„éå†æ–¹æ³•ç”¨å¯¹@autoreleasepooläº†ä¹ˆ
----------
**ä½œè€…**: [é«˜è€å¸ˆå¾ˆå¿™](https://weibo.com/517082456)

åœ¨æ¯æ¬¡éå†çš„æ—¶å€™ç”Ÿæˆäº†å¾ˆå¤šå å†…å­˜å¤§çš„å¯¹è±¡ï¼Œå¦‚æœäº¤äºé»˜è®¤çš„autoreleasepoolå»ç®¡ç†ç”Ÿå‘½å‘¨æœŸï¼Œä¼šæœ‰å› ä¸ºå†…å­˜é£™å‡äº§ç”Ÿcrashçš„é£é™©ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éœ€è¦æ‰‹åŠ¨æ§åˆ¶è¿™äº›å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸã€‚ä¹Ÿå°±æ˜¯éœ€è¦åœ¨é€‚å½“çš„ä½ç½®ä¸Šå»ä½¿ç”¨@autoreleasepool()ã€‚

ç³»ç»Ÿä¸ºæˆ‘ä»¬æä¾›äº†å¾ˆå¤šçš„éå†æ–¹æ³•ï¼Œæ¯”å¦‚è¯´**forå¾ªç¯**ã€**for-in**ã€**enumerateObjectsWithOptions:**ã€**dispatch_apply**ç­‰æ–¹æ³•ï¼Œé‚£æœ‰çš„åŒå­¦å°±è¯´éƒ½åŠ ä¸Šå§ï¼Œå°±å‡ºç°äº†ä¸‹é¢è¿™æ®µä»£ç ï¼š

![](https://github.com/iOS-Tips/iOS-tech-set/blob/master/images/2018/05/3-1.jpg)

è™½ç„¶è¯´è¿™æ ·å†™ä¹Ÿæ²¡ä»€ä¹ˆå¼‚å¸¸ï¼Œä½†æ˜¯è¿™é‡ŒçœŸçš„æœ‰å¿…è¦åŠ ä¹ˆï¼Ÿå…¶å®å¿«é€Ÿéå†è¿™å‡ ä¸ªæ–¹æ³•ç³»ç»Ÿè‡ªåŠ¨ä¸ºæˆ‘ä»¬æ·»åŠ äº†autoreleasepoolæ–¹æ³•ï¼Œä»æ–‡æ¡£é‡Œå¯ä»¥çœ‹åˆ°è››ä¸é©¬è¿¹ï¼š

![](https://github.com/iOS-Tips/iOS-tech-set/blob/master/images/2018/05/3-2.jpg)

ä¸è¿‡ï¼Œå…¶ä»–æ–¹æ³•éƒ½éœ€è¦åŠ ä¸Š@autoreleasepool()å“ˆï¼

ä½¿ç”¨ YYFPSLabel å¿«é€Ÿæ£€æµ‹é¡µé¢æ»‘åŠ¨çš„æµç•…åº¦
--------
**ä½œè€…**: [KANGZUBIN](https://weibo.com/kangzubin)

`FPS` (Frames Per Second) æ˜¯å›¾åƒé¢†åŸŸä¸­çš„å®šä¹‰ï¼Œè¡¨ç¤ºæ¯ç§’æ¸²æŸ“å¸§æ•°ï¼Œé€šå¸¸ç”¨äºè¡¡é‡ç”»é¢çš„æµç•…åº¦ï¼Œæ¯ç§’å¸§æ•°è¶Šå¤šï¼Œåˆ™è¡¨ç¤ºç”»é¢è¶Šæµç•…ï¼Œ`60fps` æœ€ä½³ã€‚

åœ¨ `iOS` å¼€å‘ä¸­ï¼Œåœ¨å¤æ‚å¸ƒå±€çš„åˆ—è¡¨é¡µé¢ï¼Œæˆ‘ä»¬é€šå¸¸éœ€è¦å¯¹åˆ—è¡¨çš„æ»‘åŠ¨è¿›è¡Œæ€§èƒ½ä¼˜åŒ–ï¼Œä»¥ä¿æŒé¡µé¢æµç•…ã€‚å¯¹äºä¿æŒæµç•…çš„ä¼˜åŒ–æŠ€å·§ï¼Œå¯ä»¥å‚è§ `@ibireme` çš„è¿™ç¯‡æ–‡ç«  **ã€ŠiOS ä¿æŒç•Œé¢æµç•…çš„æŠ€å·§ã€‹** https://blog.ibireme.com/2015/11/12/smooth_user_interfaces_for_ios/ï¼Œæˆ‘ä»¬ä¸å†èµ˜è¿°ã€‚

è¿™é‡Œä¸»è¦ä»‹ç»ä¸€ä¸‹å¦‚ä½•å¿«é€Ÿæ£€æµ‹é¡µé¢æ»‘åŠ¨çš„æµç•…åº¦ï¼Œå³å¦‚ä½•æ£€æµ‹å±å¹•çš„ `FPS` ?

`Xcode` çš„ `Instrument` æä¾›äº†ç›¸å…³çš„å·¥å…·ï¼Œè¯¦è§ `Core Animation/GPU Driver/Time Profile` ç­‰æ¨¡å—ï¼Œä½†æ˜¯ä½¿ç”¨èµ·æ¥è¿˜æ˜¯æ¯”è¾ƒç¹çï¼Œä¸ç›´è§‚ã€‚

åœ¨ **YYText** `https://github.com/ibireme/YYText) çš„ [Demo](https://github.com/ibireme/YYText/tree/master/Demo/YYTextDemo` ä¸­æä¾›äº†ä¸€ä¸ª `YYFPSLabel`ï¼Œå®ƒä½¿ç”¨ç³»ç»Ÿæä¾›çš„Â `CADisplayLink`Â çš„Â `timestamp`Â å±æ€§ï¼Œé…åˆ `timer` çš„æ‰§è¡Œæ¬¡æ•°è®¡ç®—å¾—å‡º `FPS`ï¼Œå®ç°åŸç†è¯¦è§ `YYFPSLabel` æºç å’Œè¿™ç¯‡æ–‡ç« çš„ä»‹ç»ï¼š`https://www.jianshu.com/p/878bfd38666d`

å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å·¥ç¨‹çš„ `DEBUG` æ¨¡å¼ä¸‹ï¼Œç»™ `KeyWindow` æ·»åŠ ä¸€ä¸ª `YYFPSLabel`ï¼Œå¦‚ä¸‹ï¼š

![](https://github.com/iOS-Tips/iOS-tech-set/blob/master/images/2018/05/4-1.png)

å°±å¯ä»¥åœ¨å±å¹•ä¸Šå®æ—¶çœ‹åˆ° `FPS` å€¼äº†ï¼š

![](https://github.com/iOS-Tips/iOS-tech-set/blob/master/images/2018/05/4-2.jpg)

å¦å¤–ï¼Œ`FPS` çš„å€¼è·Ÿæœºå™¨çš„å¤„ç†å™¨æ€§èƒ½æ¯æ¯ç›¸å…³ï¼Œä¸åŒçš„è®¾å¤‡çš„è¡¨ç°å¾€å¾€éƒ½ä¸åŒï¼Œå› æ­¤æˆ‘ä»¬åªè¦èƒ½ä¿è¯ `App` åœ¨ä½ç«¯è®¾å¤‡ä¸Šè¿è¡Œçš„ `FPS` ä¸º `50+`ï¼ŒåŸºæœ¬å°±å¯ä»¥è®¤ä¸ºæ˜¯æµç•…çš„äº†ã€‚

Demo åœ°å€ï¼š`https://github.com/kangzubin/XMNetworking/tree/master/Demo`




å¦‚ä½•é‡å†™è‡ªå®šä¹‰å¯¹è±¡çš„ hash æ–¹æ³•
--------
**ä½œè€…**: [halohily](https://weibo.com/halohily)

hash æ˜¯ NSObject åè®®ä¸­å®šä¹‰çš„ä¸€ä¸ªå±æ€§ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä»»ä½•ä¸€ä¸ª NSObject çš„å­ç±»éƒ½ä¼šæœ‰ hash æ–¹æ³•ï¼ˆå¯¹åº”å±æ€§çš„ getterï¼Œä¸‹æ–‡ç§°å“ˆå¸Œæ–¹æ³•ï¼‰ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ‰‹åŠ¨è°ƒç”¨è‡ªå®šä¹‰å¯¹è±¡çš„å“ˆå¸Œæ–¹æ³•ï¼Œä¼šè¿”å›å½“å‰å¯¹è±¡çš„åè¿›åˆ¶å†…å­˜åœ°å€ï¼Œè¿™æ˜¯å“ˆå¸Œæ–¹æ³•çš„çˆ¶ç±»å®ç°ã€‚

ä»€ä¹ˆæ—¶å€™å¯¹è±¡çš„å“ˆå¸Œæ–¹æ³•ä¼šè¢«è°ƒç”¨å‘¢ï¼Ÿé‚£å°±æ˜¯å®ƒè¢«åŠ å…¥ NSSet ä¸­ï¼Œæˆ–è€…ä½œä¸º NSDictionary çš„ key æ—¶ã€‚ä¸ºä»€ä¹ˆè¿™ä¸ªæ—¶å€™è°ƒç”¨å‘¢ï¼Ÿå…¶å®ä¸éš¾çŒœæµ‹ï¼Œæ˜¯ä¸ºäº†åˆ©ç”¨å“ˆå¸Œæ¥åŠ å¿«è¿™äº›æ— åºé›†åˆçš„æ£€ç´¢é€Ÿåº¦ã€‚

å½“æˆ‘ä»¬éœ€è¦é‡å†™æŸä¸ªç±»çš„ isEqual æ–¹æ³•æ—¶ï¼Œé…å¥—åœ°ä¾¿è¦é‡å†™å¯¹è±¡çš„å“ˆå¸Œæ–¹æ³•ï¼Œå› ä¸ºè¢«åˆ¤ç­‰çš„ä¸¤ä¸ªå¯¹è±¡éœ€è¦æœ‰ç›¸åŒçš„å“ˆå¸Œå€¼ï¼Œè¿™é‡Œå¯ä»¥å‚è€ƒç³»ç»Ÿå¯¹ NSString çš„å®ç°ï¼Œå…·æœ‰ç›¸åŒå†…å®¹çš„ä¸¤ä¸ª NSString çš„å®ä¾‹ isEqual æ–¹æ³•ä¼šè¿”å› trueï¼Œå®ƒä»¬çš„å“ˆå¸Œå€¼ä¹Ÿä¼šç›¸åŒï¼Œè€Œå®ƒä»¬çš„å†…å­˜åœ°å€å½“ç„¶æ˜¯ä¸ç›¸åŒçš„ã€‚æ­¤æ—¶ï¼Œå¯¹äºæˆ‘ä»¬çš„è‡ªå®šä¹‰å¯¹è±¡ï¼Œè‹¥ä¾ç„¶ä½¿ç”¨çˆ¶ç±»çš„å“ˆå¸Œæ–¹æ³•å®ç°ï¼ˆè¿”å›å¯¹è±¡å†…å­˜åœ°å€ï¼‰è‡ªç„¶æ˜¯ä¸å¯å–çš„ã€‚

é‚£ä¹ˆï¼Œè¯¥å¦‚ä½•æ­£ç¡®åœ°é‡å†™å“ˆå¸Œæ–¹æ³•å‘¢ï¼ŸMattt Thompson ç»™å‡ºäº†è‡ªå·±çš„å»ºè®®ï¼šå¯¹å…³é”®å±æ€§çš„ hash å€¼è¿›è¡Œä½æˆ–è¿ç®—ä½œä¸ºè‡ªå·±çš„ hash å€¼ã€‚åœ¨æˆ‘çš„å¶åƒ @ibireme çš„ YYModel ä¸­ï¼Œä»–å¯¹ yy_modelHash æ–¹æ³•çš„å®ç°ä¹Ÿæ˜¯é‡‡ç”¨äº†è¿™ç§æ–¹æ¡ˆã€‚

å‚è€ƒèµ„æ–™ï¼š

- [iOSå¼€å‘ ä¹‹ ä¸è¦å‘Šè¯‰æˆ‘ä½ çœŸçš„æ‡‚isEqualä¸hash!](https://www.jianshu.com/p/915356e280fc)
- [Implementing Equality and Hashing](https://www.mikeash.com/pyblog/friday-qa-2010-06-18-implementing-equality-and-hashing.html)




NSFetchedResultsController çš„å¦ä¸€ä¸ªå‘
--------
**ä½œè€…**: [Vong_HUST](https://weibo.com/VongLo)

ä¹‹å‰æœ‰åˆ†äº«è¿‡ `NSFetchedResultsController` åˆå§‹åŒ–æ—¶è®¾ç½®äº† `cacheName` ä¼šå¯¼è‡´ iOS10+ å†…å­˜æ³„éœ²çš„å‘ï¼Œå…·ä½“å¯ä»¥å‚è€ƒä¹‹å‰è¿™æ¡[å¾®åš](https://github.com/awesome-tips/iOS-Tips/blob/master/2017/11.md#nsfetchedresultscontroller%E5%85%BC%E5%AE%B9%E6%80%A7%E9%97%AE%E9%A2%98)ã€‚

ä»Šå¤©åˆ†äº«å¦ä¸€ä¸ªå‘ã€‚ç”¨è¿‡ `CoreData` çš„å¤§å®¶åº”è¯¥æ¯”è¾ƒäº†è§£ `NSFetchedResultsController`ï¼Œè¿™ä¸ªç±»è®¾è®¡ä¸ªäººè®¤ä¸ºæ˜¯ä¸ºäº†å’Œåˆ—è¡¨è§†å›¾ `UITableView/UICollectionView` åšç»‘å®šï¼Œç”±äºå®ƒå†…éƒ¨æœ‰è‡ªå¸¦ `diff` ç®—æ³•ï¼Œç»“åˆä¸¤ä¸ªåˆ—è¡¨ç±»çš„å±€éƒ¨åˆ·æ–°ç³»åˆ—æ–¹æ³•ï¼Œå¯ä»¥è¡¨ç°å‡ºè¾ƒå¥½çš„æ€§èƒ½ï¼ˆç›¸å¯¹äº `reloadData` è€Œè¨€ï¼‰ï¼Œå®ƒçš„ API å›è°ƒå…¶å®åœ¨åˆ—è¡¨è§†å›¾ä¸­éƒ½èƒ½æ‰¾åˆ°å¯¹åº”çš„åˆ·æ–°æ–¹å¼ï¼Œå¦‚å›¾
![](https://github.com/iOS-Tips/iOS-tech-set/blob/master/images/2018/05/8-1.jpg?raw=true)
![](https://github.com/iOS-Tips/iOS-tech-set/blob/master/images/2018/05/8-2.jpg?raw=true)

ä½†æ˜¯æœ‰ä¸€ä¸ªå‘ç‚¹æ˜¯ `controller:didChangeObject: atIndexPath:forChangeType:newIndexPath:` è¿™ä¸ªæ–¹æ³•çš„å›è°ƒæ—¶æœºæœ‰æ—¶å€™æ˜¯é”™è¯¯çš„ï¼Œå°±æ˜¯ä¸€ä¸ª `object` æ”¾ç”Ÿæ”¹å˜æ—¶ï¼Œä¼šè§¦å‘ä¸¤æ¬¡å›è°ƒä¸€æ¬¡æ˜¯ `Move` ä¸€æ¬¡æ˜¯ `Update`ï¼Œæœ€ç»ˆå¯¼è‡´æ•°æ®æºä¸ä¸€è‡´å¯¼è‡´å´©æºƒï¼Œå…·ä½“å¯ä»¥å‚è€ƒè‹¹æœå¼€å‘è€…è®ºå›ä¸Šçš„è¿™ä¸ª[è®¨è®º](https://forums.developer.apple.com/thread/4999)ï¼Œè®¨è®ºä¸­ç»™å‡ºäº†ä¸€ç§è§£å†³æ–¹æ¡ˆå°±æ˜¯æŠŠ `Move` æ‹†æˆ `Delete` å’Œ `Insert`ï¼Œäº²æµ‹ä¹Ÿæ˜¯å¯è¡Œçš„ã€‚

åœ¨ç”¨ `NSFetchedResultsController` æ—¶å€™ï¼Œä½ æœ‰æ²¡æœ‰é‡åˆ°å…¶ä»–é—®é¢˜å‘¢ï¼Ÿæ¬¢è¿ä¸€èµ·æ¢è®¨~








TestFlightåˆ é™¤æµ‹è¯•äººå‘˜è¡€æ³ªå²
----------
**ä½œè€…**: [é«˜è€å¸ˆå¾ˆå¿™](https://weibo.com/517082456)

TestFlightæ˜¯è‹¹æœæ¨èçš„ç°æµ‹æ–¹æ¡ˆï¼Œç›¸æ¯”è’²å…¬è‹±ï¼Œfiræ¥è¯´ä¼˜ç‚¹æœ‰å’Œæ­£å¼åŒ…æ˜¯åŒä¸€ä¸ªåŒ…ï¼Œå¤§å¤§é™ä½äº†å› ä¸ºæ‰“ä¸åŒåŒ…ä»£ç ä¸ä¸€è‡´çš„é£é™©ï¼›å¯ä»¥è¦†ç›–å®‰è£…çº¿ä¸ŠåŒ…ï¼›ä¸å—è¯ä¹¦è¿‡æœŸçš„å½±å“ç­‰ã€‚

å¦‚ä¸‹å›¾ï¼Œåˆ†å‰²çº¿ä»¥ä¸‹çš„åˆ†ç»„æ˜¯å¯ä»¥è‡ªå®šä¹‰çš„ï¼Œæ–¹ä¾¿ç»™ç‰¹å®šçš„ç”¨æˆ·ç¾¤å‘ç°æµ‹ï¼Œåç»­ä¸ç”¨å¯ä»¥æ•´ç»„åˆ é™¤ï¼›è€Œåˆ†å‰²çº¿ä»¥ä¸Šçš„åˆ†ç»„æ˜¯å›ºå®šçš„ï¼Œåªå¯ä»¥æ‰¹é‡æ·»åŠ ç”¨æˆ·ï¼Œå´ä¸èƒ½æ•´ç»„åˆ é™¤ã€‚

![](https://github.com/iOS-Tips/iOS-tech-set/blob/master/images/2018/05/6-1.jpg)

ç„¶è€Œè¢«æ‹’çš„æ˜¯å¦‚æœä¸å°å¿ƒæ‰¹é‡æ·»åŠ äº†å‡ ä¸ªæµ‹è¯•äººå‘˜åœ¨åˆ†å‰²çº¿ä»¥ä¸Šçš„åˆ†ç»„é‡Œï¼Œè¯¥å¦‚ä½•åˆ é™¤å‘¢ï¼ŸğŸ˜‚ğŸ˜‚ğŸ˜‚ä¿¡æ¯æ˜¯åˆ†é¡µåŠ è½½çš„ï¼Œæ¯é¡µåŠ è½½å‡ åæ¡ã€‚ç°åœ¨éœ€è¦æŠŠé¡µé¢å…¨éƒ¨åŠ è½½å‡ºæ¥ï¼Œå¹¶ä¸”å…¨éƒ¨å‹¾é€‰åˆ é™¤ã€‚ä¸­é—´å°è¯•äº†å†™è„šæœ¬åˆ é™¤ï¼Œå‘ç°å¹¶æ²¡æœ‰ä»€ä¹ˆç”¨ï¼ˆæ€è·¯æœ‰ç‚¹é—®é¢˜ï¼‰ï¼Œä½†å¯ä»¥ç”¨é€‰ä¸­ç¬¬ä¸€æ¡ï¼Œç„¶åæŒ‰ä½Shifté”®ï¼Œå†é€‰ä¸­æœ€åä¸€ä¸ªè§£å†³ï¼Œé‚£ä¹ˆå°±å‰©ä¸‹äº†å¦‚ä½•æŠŠæµ‹è¯•äººå‘˜å…¨éƒ½åŠ è½½å‡ºæ¥ï¼ŒğŸ˜‚ğŸ˜‚ğŸ˜‚å‘ç°é€‰ä¸­æµ‹è¯•äººå‘˜åŒºåŸŸï¼ŒæŒ‰ä½é”®ç›˜ä¸Šçš„å‘ä¸‹æŒ‰é’®å¯ä»¥ä¸€ç›´å‘ä¸‹æ»‘åŠ¨å¹¶åŠ è½½ï¼Œå¹¶åˆ©ç”¨äº†è¿™ä¸ªå¾ˆLowçš„æ–¹å¼ï¼Œä¸­åˆåƒé¥­çš„æ—¶å€™æŠŠä¸€ä¸ªç‰©ä½“å›ºå®šåœ¨é”®ç›˜ä¸ŠæŒ‰ä½è¿™ä¸ªæŒ‰é”®ï¼Œåƒé¥­å›æ¥åå°±å‘ç°9000å¤šæ¡æ•°æ®å·²ç»å…¨éƒ¨åŠ è½½å®Œæˆï¼Œç„¶åç”¨Shifté”®å…¨é€‰ååˆ é™¤äº†ğŸ˜‚ğŸ˜‚ğŸ˜‚ã€‚

å’Œå¤§å®¶äº¤æµåï¼Œåˆæœ‰äº†æ–°çš„æ€è·¯ï¼Œåˆè¯·æ•™äº†å‰ç«¯å¤§ç¥ï¼Œå‘ç°å†™è„šæœ¬æ˜¯å¯ä»¥çš„ï¼Œå¤§æ¦‚æœ‰ä»¥ä¸‹2ç±»æ€è·¯ï¼ˆç¬¬ä¸€ç§æƒ³æ³•å·²éªŒè¯æˆåŠŸï¼‰ï¼š1ï¼ŒæŠŠæ‰€æœ‰æ•°æ®æ‹‰ä¸‹æ¥ï¼Œç„¶åå†è°ƒç”¨åˆ é™¤æ¥å£ï¼›2ï¼Œåœ¨checboxå‹¾é€‰çš„æ—¶å€™ï¼Œæ˜¯æŠŠå½“å‰æµ‹è¯•äººå‘˜åŠ å…¥äº†ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œå¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¥å®ç°æ‰¹é‡åˆ é™¤æ“ä½œã€‚

å¦‚æœæœ‰æ›´å¥½çš„æ–¹æ³•ï¼Œæ¬¢è¿åˆ†äº«ï¼




å†è°ˆ UITableView çš„ estimatedRowHeight
--------
**ä½œè€…**: [KANGZUBIN](https://weibo.com/kangzubin)

ä»Šå¤©å‘ç°ä¹‹å‰å†™çš„ä¸€ä¸ªåŸºäº `UITableView` çš„åˆ—è¡¨é¡µé¢å­˜åœ¨å¦‚ä¸‹é—®é¢˜ï¼š

> å½“åˆ—è¡¨åœ¨æ»‘åŠ¨è¿‡ç¨‹ä¸­ï¼Œç‰¹åˆ«æ˜¯å¾€ä¸‹æ»‘å¿«æ¥è¿‘åº•éƒ¨æ—¶ï¼Œå³ä¾§çš„æ»šåŠ¨æ¡ä¸€ç›´åœ¨ä¸æ–­åœ°æŠ–åŠ¨ï¼Œå¹¶ä¸”æ»šåŠ¨æ¡çš„é•¿åº¦ä¹Ÿåœ¨ä¸æ–­åœ°å¾®å°å˜åŒ–ï¼›å¦å¤–ï¼Œå½“æ»‘åŠ¨åˆ°åº•éƒ¨åŠ è½½ä¸‹ä¸€é¡µæ•°æ®å¹¶ `reloadData` åï¼Œåˆ—è¡¨çš„å†…å®¹ä¼šæ•´ä½“è·³åŠ¨å¾€ä¸Šåç§»ä¸€æ®µè·ç¦»ã€‚è¿™æ˜¯ä»€ä¹ˆåŸå› å‘¢ï¼Ÿ

æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨ iOS 11 å‘å¸ƒåï¼Œ`UITableView` å‘ç”Ÿäº†ä¸€äº›å˜åŒ–ï¼Œå…¶ä¸­å¯¹ç°æœ‰é¡¹ç›®çš„ç•Œé¢å¸ƒå±€ï¼ˆåˆ—è¡¨/æ»šåŠ¨ï¼‰å½±å“æœ€å¤§åº”è¯¥æ˜¯ä»¥ä¸‹ä¸¤ç‚¹ï¼š

* (1) `UIViewController` ä¸­ç”¨äºæ ‡è®°æ˜¯å¦è‡ªåŠ¨è°ƒæ•´ `UIScrollView Insets` çš„ `automaticallyAdjustsScrollViewInsets` å±æ€§è¢«å®£å¸ƒå¼ƒç”¨ï¼Œä»£æ›¿çš„æ˜¯ `UIScrollView` è‡ªå·±æ–°å¢çš„ `contentInsetAdjustmentBehavior` å±æ€§ï¼›

* (2) `UITableView` çš„é¢„ä¼° Cell é«˜åº¦å±æ€§ `estimatedRowHeight` çš„é»˜è®¤å€¼è¢«æ”¹ä¸º `UITableViewAutomaticDimension`ï¼ˆå³é»˜è®¤å¼€å¯ï¼‰ï¼Œè€Œåœ¨ iOS 10 åŠä»¥å‰ï¼Œè¿™ä¸ªå€¼é»˜è®¤ä¸º 0ï¼ˆå³é»˜è®¤å…³é—­è¡Œé«˜ä¼°ç®—ï¼‰ã€‚

å¯¹äº (1) æˆ‘ä»¬è¿™é‡Œä¸å†èµ˜è¿°ï¼›ä½†æ˜¯å¯¹äº (2) æ¥è¯´æ—¢æ˜¯ç¦éŸ³ä¹Ÿæ˜¯å™©è€—ï¼Œå®ƒç¡®å®è§£å†³äº†ä¸€äº›æ€§èƒ½çš„é—®é¢˜ï¼Œä½†ä¹Ÿå¸¦æ¥äº†ä¸€äº›ä»¤äººå¤´ç—›çš„é—®é¢˜ã€‚

ç”±äº `UITableView` ç»§æ‰¿äº `UIScrollView`ï¼Œè€Œä¸€ä¸ª scrollView èƒ½æ»šåŠ¨çš„å‰ææ˜¯éœ€è¦è®¾ç½®å®ƒçš„ `contentSize`ã€‚å½“ tableView è¢«åŠ è½½æ—¶ï¼Œä¼šè°ƒç”¨ `heightForRowAtIndexPath` æ–¹æ³•è®¡ç®—æ¯ä¸ª Cell çš„é«˜åº¦ï¼Œç„¶åç›¸åŠ å¾—åˆ°å…¶ `contentSize`ï¼Œè¿™æ˜¾ç„¶æ˜¯è€—æ—¶åˆè€—æ€§èƒ½çš„ï¼Œå°¤å…¶æ˜¯å¯¹äºé‚£ç§é«˜åº¦å¯å˜åŒ–çš„ Cells æ›´æ˜¯å¦‚æ­¤ã€‚

æ‰€ä»¥ä¸ºäº†ä¼˜åŒ–è¿™ä¸ªé—®é¢˜ï¼Œæé«˜ `UITableView` çš„åŠ è½½é€Ÿåº¦ï¼ˆåˆå§‹åŒ–å’Œ `reloadData` æ—¶ï¼‰ï¼Œè‹¹æœå¼•å…¥äº† `estimatedRowHeight`ï¼Œæ–‡æ¡£æè¿°å¦‚ä¸‹ï¼š

![](https://github.com/awesome-tips/iOS-Tips/blob/master/images/2018/05/7-1.png)

å½“å¼€å¯ `estimatedRowHeight` æ—¶ï¼Œä¸€ä¸ª tableView è¢«åŠ è½½åï¼Œå®ƒçš„ `contentSize` çš„é«˜åº¦é€šè¿‡ `estimatedRowHeight`(é»˜è®¤ä¸º44) * Cells çš„æ•°é‡å³å¯å¾—ï¼Œä¸éœ€è¦éå† `heightForRowAtIndexPath` è·å–å¹¶ç›¸åŠ æ¥è®¡ç®—äº†ï¼Œç¼©çŸ­å…¶åŠ è½½è€—æ—¶ã€‚
 
ä½†æ˜¯æ¯ä¸ª Cell çš„çœŸå®é«˜åº¦ä»¥åŠ tableView çš„çœŸå® `contentSize` æ˜¯ä»€ä¹ˆæ—¶å€™è®¡ç®—çš„å‘¢ï¼Ÿæ­£å¦‚ä¸Šè¿°æ–‡æ¡£æ‰€è¯´ï¼Œ**æ¨è¿Ÿåˆ°æ»‘åŠ¨çš„æ—¶å€™**ï¼Œå½“æ¯ä¸ª Cell å°†è¦è¢«æ˜¾ç¤ºå‡ºæ¥æ—¶å†è®¡ç®—è·å–ï¼Œå¹¶å®æ—¶æ›´æ–° tableView çš„ `contentSize`ã€‚

è¿™ä¹Ÿè§£é‡Šäº†æˆ‘ä»¬å¼€å¤´æ‰€é‡åˆ°é—®é¢˜ï¼šå½“ tableView åŠ è½½æ—¶å¯ç”¨äº†é¢„ä¼°è¡Œé«˜ï¼Œåœ¨å¾€ä¸‹æ»‘åŠ¨æ—¶ï¼Œä¸‹é¢çš„ Cells è¢«ä¸æ–­åœ°è¢«æ˜¾ç¤ºå‡ºæ¥å¹¶æ›´æ–°äº† tableView çš„ `contentSize`ï¼ŒåŒæ—¶å¯¼è‡´å³ä¾§çš„æ»šåŠ¨æ¡çš„é«˜åº¦å’Œä½ç½®ä¹Ÿè¦ç›¸åº”æ›´æ–°ï¼Œäº§ç”Ÿâ€œæŠ–åŠ¨â€ç°è±¡ã€‚æ­¤å¤–ï¼Œå½“åŠ è½½ä¸‹ä¸€é¡µæ•°æ®å¹¶é‡æ–° `reloadData` å‘ç”Ÿè·³åŠ¨åç§»çš„åŸå› ä¹Ÿæ˜¯ç±»ä¼¼çš„ã€‚

åœ¨ iOS 11 ä¸­ï¼Œ`estimatedRowHeight` é»˜è®¤æ˜¯å¼€å¯çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾ç½® `tableView.estimatedRowHeight = 0` æ¥ç¦ç”¨ã€‚

ä½ åœ¨ä½¿ç”¨ `UITableView` æ—¶é‡åˆ°è¿‡ç±»ä¼¼çš„é—®é¢˜å—ï¼Ÿä½ æ˜¯å¦‚ä½•è§£å†³çš„ï¼Œæ¬¢è¿ç•™è¨€è®¨è®º~ 

å‚è€ƒé“¾æ¥ï¼š
* [å…³äº iOS 11 ä¸­ estimatedRowHeight](https://www.jianshu.com/p/3d9c0daddcdb)
* [Apple Docs: estimatedRowHeight](https://developer.apple.com/documentation/uikit/uitableview/1614925-estimatedrowheight?language=objc)


Quick Look Debugging
--------
**ä½œè€…**: [Lefe_x](https://weibo.com/u/5953150140)

![](https://github.com/awesome-tips/iOS-Tips/blob/master/images/2018/05/5-1.png)

ä¸Šé¢è¿™å¼ å›¾åœ¨å¼€å‘ä¸­ä½ åº”è¯¥ç»å¸¸çœ‹åˆ°ï¼Œä»Šå¤©ä¸»è¦ä»‹ç»å¿«é€Ÿè°ƒè¯•çš„ä¸€ä¸ªå°æŠ€å·§ã€‚æœ‰æ—¶å€™æƒ³çŸ¥é“æŸä¸ª image å¯¹è±¡çš„å…·ä½“å¯¹åº”çš„å›¾ç‰‡é•¿ä»€ä¹ˆæ ·ï¼›æŸæ¡è´å¡å°”æ›²çº¿çš„å½¢çŠ¶ï¼›æŸä¸ª View é•¿ä»€ä¹ˆæ ·ï¼Œå®ƒä¸Šé¢æœ‰å“ªäº›å­è§†å›¾ï¼›æŸä¸ª NSURL å¯¹è±¡æ˜¯å¦å¯ä»¥è®¿é—®ç­‰ï¼›æƒ³å¿«é€Ÿè·³è½¬åˆ°æ²™ç›’ä¸­çš„æŸä¸ªç›®å½•æ–‡ä»¶ä¸‹ã€‚ä»Šå¤©è¿™ä¸ªå°æŠ€å·§å¯ä»¥å¸®ä½ è§£å†³è¿™äº›é—®é¢˜ã€‚

ä»ç¬¬ä¸€å¼ å›¾ç›´æ¥ç‚¹å‡»å°çœ¼ç›å³å¯é¢„è§ˆå›¾ç‰‡ï¼ŒæŸ¥çœ‹è§†å›¾ï¼Œè·³è½¬åˆ°ç½‘é¡µï¼Œè¿›å…¥æ²™ç›’ç›®å½•ç­‰ã€‚

![](https://github.com/awesome-tips/iOS-Tips/blob/master/images/2018/05/5-2.png)


![](https://github.com/awesome-tips/iOS-Tips/blob/master/images/2018/05/5-3.png)


ç³»ç»Ÿé»˜è®¤æ”¯æŒä¸‹é¢è¿™å‡ ç§ç±»å‹ï¼š

- å›¾ç‰‡ï¼š UIImageï¼ŒUIImageViewï¼Œå’Œ NSBitmapImageRep éƒ½å¯ä»¥å¿«é€ŸæŸ¥çœ‹ã€‚
- é¢œè‰²ï¼š UIColor
- å­—ç¬¦ä¸²ï¼š NSString å’Œ NSAttributedStringã€‚
- å‡ ä½•ï¼š UIBezierPath å’Œ NSBezierPathï¼Œä»¥åŠ CGPointï¼ŒCGRectï¼Œå’Œ CGSizeã€‚
- åœ°åŒº CLLocation å°†æ˜¾ç¤ºä¸€ä¸ªå¾ˆå¤§çš„ï¼Œäº’åŠ¨çš„æ˜ å°„ä½ç½®ï¼Œå¹¶æ˜¾ç¤ºé«˜åº¦å’Œç²¾åº¦çš„ç»†èŠ‚ã€‚
- URLsï¼š NSURL å°†æ˜¾ç¤º URL æ‰€æŒ‡çš„æœ¬åœ°æˆ–è¿œç¨‹çš„å†…å®¹ã€‚
- æ•°æ®ï¼š NSData å°†æ¼‚äº®çš„æ˜¾ç¤ºå‡ºåç§»çš„åå…­è¿›åˆ¶å’Œ ASCII å€¼ã€‚
- è§†å›¾ï¼š æœ€åä½†å¹¶éæœ€ä¸é‡è¦çš„ï¼Œä»»ä½• UIView å­ç±»éƒ½å°†åœ¨å¿«é€ŸæŸ¥çœ‹å¼¹å‡ºæ¡†ä¸­æ˜¾ç¤ºå…¶å†…å®¹ï¼Œæ–¹ä¾¿æäº†ã€‚


å¦‚æœæƒ³è®©è‡ªå®šä¹‰çš„ç±»ä¹Ÿæ”¯æŒè¿™ç§å¿«é€Ÿè°ƒè¯•å¯ä»¥é‡å†™æ–¹æ³•

```
- (id)debugQuickLookObject
{
    // è¿”å›ç³»ç»Ÿæ”¯æŒçš„ç±»å‹
    return self.avatarImage;
}
```

[å‚è€ƒ](http://nshipster.cn/quick-look-debugging/)

å¦‚ä½•å¯¹NSMutableArrayè¿›è¡ŒKVO
--------
**ä½œè€…**: [halohily](https://weibo.com/halohily)

æˆ‘ä»¬çŸ¥é“ï¼ŒiOS ä¸­ KVO (key-value-observing) çš„åŸç†ï¼Œç®€å•æ¥è¯´å°±æ˜¯é‡å†™äº†è¢«è§‚å¯Ÿå±æ€§çš„ set æ–¹æ³•ã€‚è‡ªç„¶ï¼Œä¸€èˆ¬æƒ…å†µä¸‹åªæœ‰é€šè¿‡è°ƒç”¨ set æ–¹æ³•å¯¹å€¼è¿›è¡Œæ”¹å˜æ‰ä¼šè§¦å‘ KVOï¼Œç›´æ¥è®¿é—®å®ä¾‹å˜é‡ä¿®æ”¹å€¼æ˜¯ä¸ä¼šè§¦å‘ KVO çš„ã€‚

å¯¹äº NSMutableArray å†…å®¹çš„å˜åŒ–è¿›è¡Œè§‚å¯Ÿï¼Œæ˜¯æˆ‘ä»¬æ¯”è¾ƒå¸¸è§çš„ä¸€ä¸ªéœ€æ±‚ã€‚ä½†æ˜¯åœ¨è°ƒç”¨å®ƒçš„ addObjectã€removeObject ç³»åˆ—æ–¹æ³•æ—¶ï¼Œå¹¶ä¸ä¼šè§¦å‘å®ƒè‡ªå·±çš„ set æ–¹æ³•ã€‚æ‰€ä»¥ï¼Œå¯¹ä¸€ä¸ªå¯å˜æ•°ç»„è¿›è¡Œè§‚å¯Ÿï¼Œåœ¨å®ƒåŠ å‡å…ƒç´ æ—¶ä¸ä¼šæ”¶åˆ°æœŸæœ›çš„æ¶ˆæ¯ã€‚

é‚£ä¹ˆï¼Œè¯¥å¦‚ä½•å®ç°å¯¹ NSMutableArray çš„ KVO å‘¢ï¼Ÿå®˜æ–¹ä¸ºæˆ‘ä»¬æä¾›äº†è¿™ä¸ªæ–¹æ³•` - (NSMutableArray *)mutableArrayValueForKey:(NSString *)key`

åƒä¹‹å‰ä¸€æ ·ï¼Œä¸ºå¯å˜æ•°ç»„æ·»åŠ  KVOã€‚åœ¨åŠ å‡å…ƒç´ æ—¶ï¼Œä½¿ç”¨è¿™ä¸ªæ–¹æ³•æ¥è·å–æˆ‘ä»¬è¦è¿›è¡Œæ“ä½œçš„å¯å˜æ•°ç»„ï¼Œä¾¿å¯ä»¥åƒæ™®é€šçš„å±æ€§ä¸€æ ·ï¼Œæ”¶åˆ°å®ƒå˜åŒ–çš„æ¶ˆæ¯ã€‚

ä¸¾ä¸ªä¾‹å­ï¼ŒmyItems æ˜¯æˆ‘ä»¬è¦è¿›è¡Œ KVO çš„ä¸€ä¸ªå±æ€§ï¼Œå®ƒçš„å®šä¹‰å¦‚ä¸‹ï¼š

`@property (nonatomic, strong) NSMutableArray *myItems;`

åœ¨å®ƒè¿›è¡Œæ·»åŠ å…ƒç´ æ—¶ï¼Œä½¿ç”¨å¦‚ä¸‹æ–¹æ³•ï¼š

`[[self mutableArrayValueForKey:@"myItems"] addObject:item]; `è¿™æ ·ï¼Œæˆ‘ä»¬ä¾¿å®ç°äº†å¯¹ NSMutableArray çš„ KVOã€‚




å¯¹æ¸å˜è§†å›¾çš„å®ç°æ–¹æ¡ˆçš„æ¢ç©¶
----------
**ä½œè€…**: [é«˜è€å¸ˆå¾ˆå¿™](https://weibo.com/517082456)

å¦‚æœæƒ³å®ç°ä¸€ä¸ªè“è‰²åˆ°ç»¿è‰²çš„æ¸å˜è§†å›¾ï¼Œå¤§å®¶ä¼šæœ‰æ€æ ·çš„æ–¹æ¡ˆå‘¢ï¼Ÿ

+ é¦–å…ˆæˆ‘æƒ³åˆ°çš„æ˜¯CAGradientLayeræ¥å®ç°ï¼Œæ•ˆæœå¦‚ä¸‹å›¾ï¼š

![](https://github.com/iOS-Tips/iOS-tech-set/blob/master/images/2018/05/9-1.jpg)

çœ‹ç€æ•ˆæœè¿˜å¯ä»¥ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯å¦‚æœæƒ³å‡åŒ€è¿‡åº¦å°±ä¸è¦å»è®¾ç½®locationså±æ€§ï¼Œè¦ä¸ç„¶å°±æ˜¯å¦‚ä¸‹æ•ˆæœå–½:

![](https://github.com/iOS-Tips/iOS-tech-set/blob/master/images/2018/05/9-2.jpg)

è¿™ç§å®ç°æ–¹å¼æ¯”è¾ƒç®€å•ï¼Œå‡ è¡Œä»£ç å°±å¯ä»¥æå®šï¼Œä½†æ˜¯æ”¾å¤§å›¾ç‰‡ä¼šå‘ç°ä¼šæœ‰ä¸€äº›æ¨ªæ æ ï¼Œä¸æ˜æ˜¾ï¼Œå¦‚æœæ˜¯è§†è§‰æ•ˆæœè¦æ±‚ä¸ä¸¥æ ¼ï¼Œè¿™ç§æ–¹å¼æ˜¯å®Œå…¨æ²¡é—®é¢˜çš„ã€‚
+ Core Imageå®ç°è¿™ç§æ–¹æ¡ˆåº”è¯¥ä¹Ÿä¸åœ¨è¯ä¸‹ï¼Œæ•ˆæœå¦‚ä¸‹å›¾ï¼š

![](https://github.com/iOS-Tips/iOS-tech-set/blob/master/images/2018/05/9-3.jpg)

è‰²å½©æ›´äº®ä¸½ä¸€äº›ï¼Œä¸ªäººæ›´å–œæ¬¢è¿™ç§æ•ˆæœï¼Œå¤§å®¶å¯ä»¥æ˜æ˜¾çœ‹å‡ºå·®å¼‚æ¥ã€‚
+ ç”¨Core Graphicsæ¥å®ç°è§†å›¾çš„ç»˜åˆ¶ï¼Œå°è¯•äº†ä½¿ç”¨CGShadingRefç»˜åˆ¶ï¼Œæ•ˆæœå¦‚å›¾ï¼š

![](https://github.com/iOS-Tips/iOS-tech-set/blob/master/images/2018/05/9-4.jpg)

è¿‡åº¦æ•ˆæœä¸å¤Ÿä¸æ»‘ï¼Œåˆå°è¯•ä½¿ç”¨äº†CGGradientRefå»ç»˜åˆ¶ï¼Œæ•ˆæœå¦‚ä¸‹å›¾ï¼š

![](https://github.com/iOS-Tips/iOS-tech-set/blob/master/images/2018/05/9-5.jpg)

æ•ˆæœå¥½å¤šäº†ï¼Œè¿™ç§æ•ˆæœå’ŒCAGradientLayeræ•ˆæœæ¯”è¾ƒç›¸è¿‘ï¼Œä½†æ˜¯ä½¿ç”¨CGGradientRefç»˜åˆ¶è§†è§‰æ•ˆæœæ›´å¥½ä¸€äº›ï¼ˆä¸“é—¨è¯·æ•™äº†è®¾è®¡å¸ˆï¼Œè™½ç„¶æˆ‘çš„è‚‰çœ¼å‡¡èƒå¹¶æ²¡æœ‰çœ‹å‡ºæ˜æ˜¾å·®å¼‚ï¼Œä½†æ˜¯æ”¾å¤§åæ¨ªæ¡æ˜æ˜¾å°‘ä¸€äº›ï¼‰ã€‚

GPUImageåº”è¯¥ä¹Ÿæ˜¯å¯ä»¥å®ç°çš„ï¼Œå¤§å®¶å¯ä»¥å°è¯•ä¸€ä¸‹ï¼

å…³äºæ•ˆç‡ï¼Œæˆ‘ç®€å•æµ‹è¯•äº†ä¸€ä¸‹(ç»˜åˆ¶200x200ï¼Œè“è‰²åˆ°ç»¿è‰²æ¸å˜ï¼Œç»˜åˆ¶äº†10æ¬¡çš„å¹³å‡å€¼)ï¼š

![](https://github.com/iOS-Tips/iOS-tech-set/blob/master/images/2018/05/9-6.jpg)

ä½¿ç”¨CGGradientRefç»˜åˆ¶æ•ˆç‡æ¯”å…¶ä»–æ–¹å¼è¦çªå‡ºä¸€äº›ã€‚

å¤§å®¶å¯ä»¥æ ¹æ®ä¸åŒåœºæ™¯æ¥ä½¿ç”¨ä¸åŒçš„æ–¹å¼å»ç»˜åˆ¶ï¼Œå¦‚æœæœ‰æ›´å¥½çš„æ–¹æ¡ˆï¼Œæ¬¢è¿ä¸€èµ·è®¨è®ºï¼




RACObserve å¸¸è§ç”¨æ³•åŠåŒºåˆ«
--------
**ä½œè€…**: [Vong_HUST](https://weibo.com/VongLo)

ç”¨è¿‡ [`ReactiveCocoa`](https://github.com/ReactiveCocoa/ReactiveCocoa/tree/v2.5) çš„åº”è¯¥éƒ½æ¯”è¾ƒç†Ÿæ‚‰è¿™ä¸ª `RACObserve` è¿™ä¸ªå®ï¼Œä½†æ˜¯ä¸çŸ¥é“å¤§å®¶æœ‰æ²¡æœ‰å¯¹è¿™ä¸ªå®å…·ä½“å±•å¼€ï¼Œè¿›è¡Œåˆ†æã€‚

æ¯”è¾ƒå¸¸è§çš„ç”¨æ³•å°±æ˜¯ `RACObserve(someTarget, someProperty)`ï¼Œä½†æ˜¯å¤§å®¶äº†è§£ `RACObserve(target.someTarget, someProperty)` å’Œ `RACObserve(target, someTarget.someProperty)` ä¹‹é—´çš„åŒºåˆ«ä¹ˆï¼Ÿå…·ä½“å¯ä»¥çœ‹ä»¥ä¸‹ä»£ç ç‰‡æ®µä»¥åŠæ‰§è¡Œçš„ç»“æœ

```objc
self.label = [UILabel new];
self.label.text = @"123";

[RACObserve(self.label, text) subscribeNext:^(id x) {
    NSLog(@"RACObserve(self.label, text) çš„æ–¹å¼ %@", x);
}];

[RACObserve(self, label.text) subscribeNext:^(id x) {
    NSLog(@"RACObserve(self, label.text) çš„æ–¹å¼ %@", x);
}];

self.label.text = @"1234";
self.label = [UILabel new];
self.label.text = @"12345";

// output

RACObserve(self.label, text) çš„æ–¹å¼ 123
RACObserve(self, label.text) çš„æ–¹å¼ 123
RACObserve(self, label.text) çš„æ–¹å¼ 1234
RACObserve(self.label, text) çš„æ–¹å¼ 1234
RACObserve(self, label.text) çš„æ–¹å¼ (null)
RACObserve(self, label.text) çš„æ–¹å¼ 12345
```

ä»¥ä¸Šé¢ä»£ç ä¸ºä¾‹ï¼Œ`RACObserve(self.label, text)` å…¶å®æ˜¯ç›‘å¬ `self.label` è¿™ä¸ªå¯¹è±¡çš„ `text` å±æ€§ï¼Œæ‰€ä»¥å½“è¿™ä¸ªå¯¹è±¡ `text` å‘ç”Ÿå˜åŒ–æ—¶ï¼Œç¬¬ä¸€ä¸ªæ˜¯ `block` æ˜¯èƒ½å¤Ÿæ”¶åˆ°å›è°ƒçš„ï¼Œä½†æ˜¯å½“ `self.label` è¢«é‡æ–°èµ‹å€¼åï¼ŒåŸæ¥çš„ `label` æ— äººæŒæœ‰ç›¸å½“äºå˜æˆäº† `nil`ï¼Œæ‰€ä»¥ç¬¬ä¸€ä¸ª `block` å°†ä¸å†ç”Ÿæ•ˆã€‚è€Œ `RACObserve(self, label.text)` ç›‘å¬çš„æ˜¯ selfï¼Œç„¶å `keyPath` æ˜¯ `label.text`ï¼Œæ‰€ä»¥å½“ `label` æˆ–è€…å…¶ `text` å‘ç”Ÿå˜åŒ–éƒ½ä¼šè§¦å‘è¿™ä¸ªå›è°ƒã€‚æ‰€ä»¥åŒºåˆ«åœ¨äº `target` ä»¥åŠ `keyPath` çš„è®¾ç½®ã€‚

å¦‚æœä¸Šè¿°è¡¨è¾¾æœ‰ä¸æ°å½“çš„åœ°æ–¹ï¼Œæ¬¢è¿æŒ‡å‡ºï¼Œä¸€èµ·æ¢è®¨~








iOS è‡ªå¸¦ä¹å®«æ ¼æ‹¼éŸ³é”®ç›˜ä¸ Emoji è¡¨æƒ…ä¹‹é—´çš„å‘
--------
**ä½œè€…**: [KANGZUBIN](https://weibo.com/kangzubin)

æœ€è¿‘äº§å“æäº†ä¸€ä¸ªéœ€æ±‚ï¼šè¦æ±‚æŸä¸ªâ€œè¾“å…¥æ¡†â€ç¦æ­¢è¾“å…¥ Emoji è¡¨æƒ…ï¼Œæˆ‘ä»¬èƒ½æƒ³åˆ°çš„æ–¹æ¡ˆæ˜¯ï¼šåœ¨ `UITextField` çš„ `textField:shouldChangeCharactersInRange:replacementString:` ä»£ç†æ–¹æ³•ä¸­åˆ¤æ–­å³å°†è¾“å…¥çš„å­—ç¬¦ä¸²æ˜¯å¦åŒ…å« Emoji è¡¨æƒ…ï¼Œå¦‚æœåŒ…å«ï¼Œå°±åœ¨è¯¥æ–¹æ³•ä¸­è¿”å› `NO`ï¼Œä¸å…è®¸è¾“å…¥ã€‚

å…³äºå¦‚ä½•åˆ¤æ–­ä¸€å­—ç¬¦ä¸²æ˜¯å¦åŒ…å« Emoji è¡¨æƒ…çš„æ–¹æ³•ï¼Œç½‘ä¸Šå·²ç»æœ‰å¾ˆå¤šä»£ç ç‰‡æ®µï¼Œä¸€èˆ¬æ˜¯é€šè¿‡ `Unicode` ç¼–ç èŒƒå›´æ¥åˆ¤æ–­ ï¼Œè¯¦è§è¿™é‡Œï¼š[https://gist.github.com/cihancimen/4146056](https://gist.github.com/cihancimen/4146056) ï¼Œæ–¹æ³•åè®°ä¸ºï¼š

```
- (BOOL)stringContainsEmoji:(NSString *)string;
```

æŒ‰ç…§ä¸Šè¿°æ€è·¯å¼€å‘å®Œåï¼ŒEmoji è¡¨æƒ…ç¡®å®æ˜¯è¢«é™åˆ¶ä½æ— æ³•è¾“å…¥äº†ï¼Œä½†æ˜¯å½“æŠŠé”®ç›˜åˆ‡æ¢ä¸º iOS ç³»ç»Ÿè‡ªå¸¦çš„ä¹å®«æ ¼æ‹¼éŸ³é”®ç›˜å‡†å¤‡è¾“å…¥æ±‰å­—æ—¶ï¼Œå´å‘ç°æ‹¼éŸ³æ— æ³•è¾“å…¥ã€‚è¿™æ˜¯æ€ä¹ˆå›äº‹ï¼Ÿ

é¦–å…ˆé€šè¿‡è§‚å¯Ÿç³»ç»Ÿè‡ªå¸¦æ‹¼éŸ³é”®ç›˜çš„è¡Œä¸ºï¼Œå¯ä»¥å‘ç°ï¼Œå½“é€šè¿‡æ‹¼éŸ³æ¥è¾“å…¥æ±‰å­—æ—¶ï¼Œç³»ç»Ÿä¼šå…ˆåœ¨è¾“å…¥æ¡†ä¸­â€œé¢„è¾“å…¥â€æ‹¼éŸ³å­—æ¯ä½œä¸ºå ä½ï¼Œç­‰ç”¨æˆ·åœ¨é”®ç›˜ä¸Šé€‰ä¸­æ±‰å­—æ—¶ï¼Œè¾“å…¥æ¡†ä¸­çš„å ä½â€œæ‹¼éŸ³å­—æ¯â€å°±ä¼šè¢«æ›¿æ¢ä¸ºæ‰€å¯¹åº”çš„æ±‰å­—ï¼Œå¦‚ä¸‹å›¾ï¼š

![](https://github.com/awesome-tips/iOS-Tips/blob/master/images/2018/05/10-1.jpg)

é€šè¿‡æ–­ç‚¹è°ƒè¯•æˆ‘ä»¬è¿˜å‘ç°ï¼Œåœ¨è¾“å…¥æ‹¼éŸ³è¿‡ç¨‹ä¸­ï¼Œä»¥â€œçŸ¥è¯†å°é›†â€ï¼ˆzhishixiaojiï¼‰ä¸ºä¾‹ï¼Œå½“æˆ‘ä»¬é€šè¿‡ç‚¹å‡»ç¬¬ 9 ä¸ªé”®æ¥è¾“å…¥å­—æ¯ `z` æ—¶ï¼Œåœ¨ UITextField çš„ä»£ç†æ–¹æ³•ä¸­è·å–åˆ°çš„å³å°†è¾“å…¥çš„å­—ç¬¦ä¸æ˜¯ `z` ï¼Œè€Œæ˜¯ä¸€ä¸ªç¬¦å· â’ ï¼Œè€Œè¾“å…¥ç»“æŸåï¼ˆ`textFieldDidChange:`ï¼‰è¯¥ç¬¦å· â’ å°±ä¼šè¢«æ›¿æ¢ä¸ºæ‰€å¯¹åº”çš„å­—æ¯ï¼Œç„¶åå½“ç‚¹å‡»ç¬¬ 4 ä¸ªé”®æ¥è¾“å…¥å­—æ¯ `h` æ—¶ï¼ŒåŒæ ·åœ°å¾—åˆ°å³å°†è¾“å…¥çš„å­—ç¬¦ä¸º â ï¼Œç„¶åå†è¢«æ›¿æ¢ä¸º `h`ï¼Œä»¥æ­¤ç±»æ¨...

æˆ‘ä»¬çŒœæµ‹ï¼Œè‹¹æœä¹‹æ‰€ä»¥è¿™ä¹ˆåšæ˜¯å› ä¸ºï¼Œå¯¹äºä¹å®«æ ¼æ‹¼éŸ³é”®ç›˜ï¼Œä¸€ä¸ªé”®ä»£è¡¨ç€ 3 æˆ– 4 ä¸ªå­—æ¯ï¼Œå½“ä½ ç‚¹å‡»ä¸€ä¸ªé”®æ—¶ï¼Œå®ƒå¹¶ä¸çŸ¥é“ä½ è¦è¾“å…¥é‚£ä¸ªå­—æ¯ï¼Œæ‰€ä»¥ç”¨ä¸€ä¸ªå¸¦åœ†åœˆçš„æ•°å­—ç¬¦å·ä½œä¸ºä¸´æ—¶å ä½ï¼Œç­‰è¾“å…¥ç»“æŸæ—¶æ‰æ›¿æ¢ä¸ºç›¸åº”çš„å­—æ¯ã€‚

åœ¨ä¹å®«æ ¼æ‹¼éŸ³é”®ç›˜ä¸­ï¼Œ"ABC" é”® ~ "WXYZ" é”®æ‰€å¯¹åº”çš„ä¸´æ—¶å ä½ç¬¦å·åˆ†åˆ«ä¸º â‹âŒ ... â’ ï¼Œè¡¨æƒ… "^-^" é”®æ‰€å¯¹åº”çš„ä¸ºç¬¦å· â˜» ï¼Œè€Œè¿™äº›ç¬¦å·åœ¨ `stringContainsEmoji:` æ–¹æ³•ä¸­åˆšå¥½éƒ½è¢«åˆ¤ä¸ºæ˜¯ Emojiï¼Œæ‰€ä»¥å½“è¾“å…¥æ¡†ç¦æ­¢è¾“å…¥ Emoji è¡¨æƒ…æ—¶ï¼Œå°±ä¼šå¯¼è‡´æ‹¼éŸ³ä¹Ÿæ— æ³•è¾“å…¥ã€‚

è§£å†³æ–¹æ¡ˆå°±æ˜¯åœ¨ Emoji åˆ¤å®šæ–¹æ³•ä¸­ï¼Œè¿‡æ»¤æ‰ä¸Šè¿°ç¬¦å·ï¼ˆå¯¹åº”çš„ `Unicode` ç¼–ç ä¸º `U+278b` ~ `U+2792` å’Œ `U+263b`ï¼‰ï¼Œå¦‚ä¸‹ï¼š

![](https://github.com/awesome-tips/iOS-Tips/blob/master/images/2018/05/10-2.png)

ä½†æˆ‘ä»¬å‘ç°ç³»ç»Ÿè‡ªå¸¦çš„â€œå…¨é”®ç›˜æ‹¼éŸ³è¾“å…¥â€ä¸ä¼šæœ‰ä¸Šè¿°é—®é¢˜ï¼Œå› ä¸ºæ¯ä¸ªé”®éƒ½åªä»£è¡¨ä¸€ä¸ªå­—æ¯ï¼š

![](https://github.com/awesome-tips/iOS-Tips/blob/master/images/2018/05/10-3.jpg)

è€Œä¸”ï¼Œå›½å†…å¸¸ç”¨çš„ç¬¬ä¸‰æ–¹è¾“å…¥æ³•ä¹Ÿä¸ä¼šæœ‰è¿™ä¸ªé—®é¢˜ï¼Œå› ä¸ºå®ƒä»¬ä¸ä¼šåœ¨è¾“å…¥æ¡†ä¸­â€œé¢„è¾“å…¥â€æ‹¼éŸ³å­—ç¬¦ï¼ˆè€Œæ˜¯æŠŠæ‹¼éŸ³æ˜¾ç¤ºåœ¨é”®ç›˜ä¸Šæ–¹ï¼‰ï¼Œåªæœ‰ç­‰ç”¨æˆ·é€‰ä¸­æ±‰å­—æ—¶ï¼Œæ‰æŠŠæ±‰å­—å¡«å†™åˆ°è¾“å…¥æ¡†ä¸­ï¼Œå¦‚ä¸‹ï¼ˆæœç‹—è¾“å…¥æ³•ï¼‰ï¼š

![](https://github.com/awesome-tips/iOS-Tips/blob/master/images/2018/05/10-4.jpg)


Fix All issue
--------
**ä½œè€…**: [å—å³°å­](https://weibo.com/touristdiary)

æˆ‘ä»¬åœ¨å†™ä»£ç æ—¶ï¼Œå¯èƒ½ä¸ç»æ„æ²¡æœ‰é€šè¿‡ Refactor -> Rename ä¿®æ”¹äº†æŸä¸ªæ–¹æ³•åï¼Œæˆ–è€…ç±»ä¼¼äº Swift è¿™ç§ç ´åå¼å‡çº§ï¼Œæˆ–è€…å…¶å®ƒå„ç§åŸå› ï¼Œè€Œé€ æˆå¤šä¸ªå¤šä¸ªé”™è¯¯ã€‚

![](https://github.com/awesome-tips/iOS-Tips/blob/master/images/2018/05/11-1.png)

Xcode ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªåŠŸèƒ½ï¼šFix All Issuesï¼Œåªè¦ Xcode çŸ¥é“é—®é¢˜åœ¨å“ªï¼Œå°±å¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼ä¸€æ¬¡æ€§è§£å†³è¿™äº›é—®é¢˜ã€‚

![](https://github.com/awesome-tips/iOS-Tips/blob/master/images/2018/05/11-2.png)

![](https://github.com/awesome-tips/iOS-Tips/blob/master/images/2018/05/11-3.png)



å¦‚ä½•æ­£ç¡®ä½¿ç”¨åˆå§‹åŒ–æ–¹æ³•çš„æ ‡è®°å®
--------
**ä½œè€…**: [halohily](https://weibo.com/halohily)

åœ¨ Objective-C ä¸­æœ‰ designated å’Œ secondary åˆå§‹åŒ–æ–¹æ³•çš„è§‚å¿µã€‚å¦‚æœä¸€ä¸ªå®ä¾‹çš„åˆå§‹åŒ–éœ€è¦å¤šä¸ªå‚æ•°ï¼Œé‚£ä¹ˆä½¿ç”¨æ‰€æœ‰å‚æ•°è¿›è¡Œåˆå§‹åŒ–çš„æ–¹æ³•å¯ä»¥ä½œä¸º designated åˆå§‹åŒ–æ–¹æ³•ã€‚è€Œä½¿ç”¨ä¸€ä¸ªæˆ–å¤šä¸ªå‚æ•°çš„åˆå§‹åŒ–æ–¹æ³•åˆ™ä½œä¸º secondary åˆå§‹åŒ–æ–¹æ³•ï¼Œå¹¶ä¸”åœ¨å¯¹åº”å®ç°ä¸­è°ƒç”¨å‰é¢çš„ designated åˆå§‹åŒ–æ–¹æ³•ã€‚

åœ¨å¼€å‘æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ NS_DESIGNATED_INITIALIZER å®å¯¹ designated åˆå§‹åŒ–æ–¹æ³•è¿›è¡Œæ ‡è®°ï¼Œç”¨æ¥å‘è°ƒç”¨è€…æ˜ç¡®ï¼Œæ— è®ºå…¶ä»–å“ªä¸ªåˆå§‹åŒ–æ–¹æ³•éƒ½ä¼šé€šè¿‡è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ¥å®ç°ã€‚å¯¹äºä¸æƒ³è®©è°ƒç”¨è€…ä½¿ç”¨çš„åˆå§‹åŒ–æ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨ NS_UNAVAILABLE å®æ¥è¿›è¡Œæ ‡è®°ç¦ç”¨ã€‚è¿™æ ·ä¸€æ¥ï¼ŒXcode çš„è‡ªåŠ¨è¡¥å…¨ä¸ä¼šç´¢å¼•åˆ°è¯¥æ–¹æ³•ï¼Œå¦‚æœå¼ºåˆ¶è°ƒç”¨ï¼Œç¼–è¯‘å™¨ä¼šæŠ¥é”™ï¼ˆä½†æ˜¯é€šè¿‡ runtime è¿˜æ˜¯å¯ä»¥è°ƒç”¨çš„ï¼‰ã€‚

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè‹¥ä¸ºå­ç±»æŒ‡å®šäº†ä¸€ä¸ª NS_DESIGNATED_INITIALIZER å®æ ‡è®°çš„åˆå§‹åŒ–æ–¹æ³•ï¼Œ**é‚£ä¹ˆåœ¨å­ç±»ä¸­å¿…é¡»é‡å†™çˆ¶ç±»çš„ designated åˆå§‹åŒ–æ–¹æ³•ï¼Œè¯¥æ–¹æ³•çš„å®ç°æ˜¯è°ƒç”¨å­ç±»è‡ªèº«çš„ designated åˆå§‹åŒ–æ–¹æ³•ã€‚åœ¨å­ç±»è‡ªèº«çš„  designated åˆå§‹åŒ–æ–¹æ³•çš„å®ç°ä¸­ï¼Œåˆéœ€è¦è°ƒç”¨çˆ¶ç±»çš„ designated åˆå§‹åŒ–æ–¹æ³•ã€‚**è¿™æ®µè¯æ¯”è¾ƒç»•ï¼Œä¸‹é¢æä¾›ä¸€ä¸ªä¾‹å­è¯´æ˜ã€‚

```objective-c
@interface AwesomeTips : NSObject
//è¯¥æ–¹æ³•è¢«ç¦ç”¨
- (instancetype)new NS_UNAVAILABLE;
//secondaryåˆå§‹åŒ–æ–¹æ³•
- (instancetype)initWithName:(NSString *)aName;
//designatedåˆå§‹åŒ–æ–¹æ³•
- (instancetype)initWithName:(NSString *)aName wish:(NSString *)ourWish NS_DESIGNATED_INITIALIZER;
@end
```

```objective-c
#import "AwesomeTips.h"

@interface AwesomeTips ()
@property (nonatomic, copy) NSString *name;
@property (nonatomic, copy) NSString *wish;
@end

@implementation AwesomeTips

//çˆ¶ç±»NSObjectçš„designatedæ–¹æ³•ä¸ºinitï¼Œè¿™é‡Œå¿…é¡»é‡å†™
//å¦åˆ™è­¦å‘Šâ€œMethod override for the designated initializer of the superclass '-init' not foundâ€
//åœ¨å…¶é‡å†™å®ç°ä¸­ï¼Œè°ƒç”¨å­ç±»æŒ‡å®šçš„designatedæ–¹æ³•ï¼Œå¹¶æä¾›é»˜è®¤å‚æ•°
- (instancetype)init {
    return [self initWithName:@"çŸ¥è¯†å°é›†" wish:@"åˆ†äº«çŸ¥è¯†"];
}

//secondaryåˆå§‹åŒ–æ–¹æ³•çš„å®ç°ï¼Œè°ƒç”¨è‡ªèº«çš„designatedæ–¹æ³•
- (instancetype)initWithName:(NSString *)aName {
    return [self initWithName:aName wish:@"åˆ†äº«çŸ¥è¯†"];
}

//è‡ªèº«çš„designatedåˆå§‹åŒ–æ–¹æ³•
//éœ€å…ˆè°ƒç”¨çˆ¶ç±»çš„designatedæ–¹æ³•ï¼Œè€Œåä½¿ç”¨å‚æ•°èµ‹å€¼
- (instancetype)initWithName:(NSString *)aName wish:(NSString *)ourWish {
    if (self = [super init]) {
        self.name = aName;
        self.wish = ourWish;
    }
    return self;
}

@end
```



è¢«å¤§å®¶å¿½ç•¥çš„UIViewControllerä¸¤å¯¹API
----------
**ä½œè€…**: [é«˜è€å¸ˆå¾ˆå¿™](https://weibo.com/517082456)

åœ¨æŸä¸ªé¡µé¢è¢«popæˆ–è€…dismissViewControllerçš„æ—¶å€™ï¼Œéœ€è¦æ‰§è¡ŒæŸä¸ªæ“ä½œï¼Œå¤§å®¶ä¼šæ€ä¹ˆåšå‘¢ï¼Ÿswizzle deallocæ–¹æ³•ï¼Ÿè¿™æ ·åšæ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼›å…¶å®UIViewControllerä¸ºæˆ‘ä»¬æä¾›äº†ä¸¤å¯¹APIã€‚
é’ˆå¯¹add childViewControllerå’Œremove childViewController:

![](https://github.com/iOS-Tips/iOS-tech-set/blob/master/images/2018/05/13-1.jpg)

å½“ç„¶ï¼ŒPushå’ŒPopä¹Ÿæ˜¯é€‚ç”¨çš„ã€‚

é’ˆå¯¹Presentå’ŒDismiss:

![](https://github.com/iOS-Tips/iOS-tech-set/blob/master/images/2018/05/13-2.jpg)

é‚£å‰é¢æåˆ°çš„é—®é¢˜å°±å¯ä»¥åœ¨viewWillDisappear:æˆ–è€…viewDidDisappear:é‡Œé¢å»åˆ¤æ–­self.beingDismissedæˆ–è€…self.movingFromParentViewControllerã€‚

è™½ç„¶æ˜¯iOS5ä¹‹åå°±æœ‰äº†ï¼Œä½†è¢«å¾ˆå¤šå¼€å‘ç«¥é‹å¿½ç•¥å’Œé—å¿˜äº†ï¼Œæœ‰åº”ç”¨åˆ°çš„åœºæ™¯ï¼Œå¤§å®¶å¯ä»¥ç”¨èµ·æ¥å“ˆï¼


UIScrollView æ‹–æ‹½æ»‘åŠ¨æ—¶æ”¶èµ·é”®ç›˜
--------
**ä½œè€…**: [KANGZUBIN](https://weibo.com/kangzubin)

å½“ä¸€ä¸ªé¡µé¢çš„ UIScrollView/UITableView ä¸Šæœ‰ä¸€ä¸ªæˆ–å¤šä¸ªè¾“å…¥æ¡†æ—¶ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦åšä¸€ä»¶äº‹å°±æ˜¯å½“åˆ—è¡¨æ‹–æ‹½/æ»‘åŠ¨æ—¶ï¼Œå°±æ”¶èµ·å·²ç»å¼¹èµ·çš„é”®ç›˜ã€‚

æˆ‘ä»¬å·¥ç¨‹ä¸­ä¹‹å‰ä¸€ç›´æ˜¯è¿™ä¹ˆå¤„ç†çš„ï¼šåœ¨ UIScrollView çš„ `scrollViewWillBeginDragging` ä»£ç†æ–¹æ³•ï¼ˆæ­¤æ–¹æ³•åœ¨ç”¨æˆ·å°†è¦å¼€å§‹æ‹–åŠ¨ scrollView æ—¶è°ƒç”¨ï¼‰ä¸­ï¼Œè°ƒç”¨ keyWindow çš„ `endEditing:` æ–¹æ³•å…³é—­é”®ç›˜ï¼Œä»£ç å¦‚ä¸‹ï¼š

```
- (void)scrollViewWillBeginDragging:(UIScrollView *)scrollView {
    // å¼€å§‹æ‹–æ‹½æ»‘åŠ¨æ—¶ï¼Œæ”¶èµ·é”®ç›˜
    [[[UIApplication sharedApplication] keyWindow] endEditing:YES];
}
```

ä»Šå¤©å‘ç°ï¼ŒåŸæ¥åœ¨ iOS 7 ä»¥åï¼ŒUIScrollView å¢åŠ äº†ä¸€ä¸ª **keyboardDismissMode** å±æ€§æ¥å®Œæˆè¿™ä»¶äº‹ï¼Œä½ åªéœ€è¦å†™ä¸€è¡Œä»£ç å°±å¯å®ç°ä¸Šè¿°åŠŸèƒ½ï¼š

```
self.tableView.keyboardDismissMode = UIScrollViewKeyboardDismissModeOnDrag;
```

å…¶ä¸­ï¼ŒUIScrollViewKeyboardDismissMode æœ‰ä¸‰ä¸ªæšä¸¾å€¼åˆ†åˆ«å¦‚ä¸‹ï¼š

* UIScrollViewKeyboardDismissModeNone: é»˜è®¤å€¼ï¼ŒscrollView çš„æ‹–æ‹½æ»‘åŠ¨å¯¹é”®ç›˜çŠ¶æ€ä¸ä¼šæœ‰å½±å“

* UIScrollViewKeyboardDismissModeOnDrag: å½“åˆšæ‹–æ‹½ scrollView æ—¶å°±ä¼šæ”¶èµ·å…³é—­é”®ç›˜

* UIScrollViewKeyboardDismissModeInteractive: å½“æ‹–æ‹½ scrollView å‘ä¸‹æ»‘åŠ¨æ—¶ï¼Œé”®ç›˜ä¼šè·Ÿéšæ‰‹åŠ¿æ»‘åŠ¨ï¼Œå½“åˆå¾€ä¸Šæ»‘åŠ¨æ—¶ï¼Œé”®ç›˜ä¹Ÿä¼šè·Ÿç€å‘ä¸Šå¹¶å–æ¶ˆå…³é—­ã€‚

åˆæ¶¨çŸ¥è¯†äº†...ğŸ‘»

å‚è€ƒé“¾æ¥ï¼š[keyboardDismissMode](https://developer.apple.com/documentation/uikit/uiscrollview/1619437-keyboarddismissmode?language=objc)


iOS å¦‚ä½•è°ƒè¯• WebView
--------
**ä½œè€…**: [Lefe_x](https://weibo.com/u/5953150140)

ç›®å‰ iOS ç«¯å‡ ä¹éƒ½ä¼šæ¥å…¥ Web é¡µé¢ï¼Œä¸å‰ç«¯æ¥è§¦ä¹Ÿè¶Šæ¥è¶Šå¤šï¼Œå¦‚æœä¸äº†è§£ç‚¹å‰ç«¯çŸ¥è¯†ï¼Œå½“å‡ºç°é—®é¢˜çš„æ—¶å€™åŒæ–¹æ²Ÿé€šèµ·æ¥éå¸¸ä¸é¡ºç•…ï¼Œä¾¿å¼€å§‹æ¥è§¦å‰ç«¯ã€‚æˆ‘ä»¬ä»Šå¤©èŠèŠå¦‚ä½•è°ƒè¯• Web é¡µã€‚å½“è¿è¡Œ APP çš„æ—¶å€™ï¼ŒiOS ç«¯åŠ è½½ WebViewï¼ˆWKWebView æˆ– UIWebView ï¼‰æ—¶å¯ä»¥é€šè¿‡ Mac è‡ªå¸¦çš„ Safari æ¥è°ƒè¯•æ‰€æ˜¾ç¤ºçš„é¡µé¢ï¼Œå…¶å®è°ƒè¯• JSPatch çš„æ—¶å€™ä¹Ÿæ˜¯è¿™ä¹ˆç”¨çš„ã€‚

æˆ‘ä»¬æ¥æ¨¡æ‹ŸåŠ è½½ Web é¡µæ—¶çš„åœºæ™¯ï¼Œé¦–å…ˆéœ€è¦å¼€å¯æœ¬åœ°çš„ WebServerï¼Œmac è‡ªå¸¦ Apache æœåŠ¡å™¨ï¼Œæˆ‘ä»¬åªéœ€å¯åŠ¨è¿™ä¸ªæœåŠ¡å™¨ï¼Œå³å¯åŠ è½½ä¸€ä¸ªç½‘é¡µã€‚

```
// å¼€å¯ Apache
sudo apachectl start
```

Apache å¼€å¯åï¼Œç«™ç‚¹çš„ç›®å½•åœ¨ `/Library/WebServer/Documents` ä¸‹ï¼Œæˆ‘ä»¬æŠŠå†™å¥½çš„ç½‘é¡µæ”¾åˆ°è¿™ä¸ªç›®å½•ä¸‹ï¼Œç„¶åç›´æ¥å¯ä»¥æ ¹æ® URL è®¿é—®å¯¹åº”çš„é¡µé¢ï¼Œæ¯”å¦‚åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ï¼š`http://ç”µè„‘ipåœ°å€/web/index.html` å³å¯è®¿é—® `index.html` è¿™ä¸ªé¡µé¢ã€‚

ä½¿ç”¨ WKWebView åŠ è½½ `index.html` è¿™ä¸ªé¡µé¢ï¼Œå³å¯è°ƒè¯•è¿™ä¸ªé¡µé¢ï¼Œè°ƒè¯•å‰éœ€è¦åšä»¥ä¸‹ä¸¤ä»¶äº‹ï¼š

- æ‰‹æœºç«¯å¼€å¯Web æ£€æŸ¥å™¨ï¼šè®¾ç½® -> é€šç”¨ -> Safari -> é«˜çº§ -> Web æ£€æŸ¥å™¨
- Macç«¯æ˜¾ç¤ºå¼€å‘èœå•ï¼šSafari æµè§ˆå™¨é»˜è®¤æ²¡æœ‰æ˜¾ç¤ºâ€œå¼€å‘â€èœå•ï¼Œéœ€è¦é€šè¿‡ï¼šSafari æµè§ˆå™¨  -> åå¥½è®¾ç½® -> é«˜çº§ -> å‹¾é€‰åœ¨èœå•ä¸­æ˜¾ç¤ºâ€œå¼€å‘â€è®¾ç½®ã€‚

è®¾ç½®å®Œåï¼Œå½“å¯åŠ¨ APP ï¼ŒåŠ è½½ WKWebView åå³å¯çœ‹åˆ° `index.html` è¿™ä¸ªé¡µé¢ã€‚è¿™æ—¶å³å¯é€šè¿‡æ–­ç‚¹è¿›è¡Œè°ƒè¯•ï¼Œå½“ç„¶å¯ä»¥æŸ¥çœ‹å½“å‰çš„ HTML ä»£ç ï¼ŒJS ä»£ç ï¼Œç½‘ç»œæƒ…å†µç­‰ã€‚å…·ä½“å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![](https://github.com/awesome-tips/iOS-Tips/blob/master/images/2018/05/12-1.jpg)

![](https://github.com/awesome-tips/iOS-Tips/blob/master/images/2018/05/12-2.jpg)


å¦‚ä½•å®šåˆ¶ä¸€ä¸ª UIView ç±»å‹æ§ä»¶çš„å‡ºå…¥åŠ¨ç”»
--------
**ä½œè€…**: [halohily](https://weibo.com/halohily)

åœ¨iOSå¼€å‘ä¸­ï¼Œè‡ªå®šä¹‰çš„å¼¹å±‚ç»„ä»¶éå¸¸å¸¸è§ï¼Œæ¯”å¦‚åˆ†äº«æ¡†ã€è‡ªå®šä¹‰çš„  actionSheet ç»„ä»¶ç­‰ã€‚æœ‰çš„åœºæ™¯ä¸‹ï¼Œä¼šé€‰æ‹©ä½¿ç”¨ UIViewController ç±»å‹æ¥å®ç°ï¼Œè¿™æ—¶å®šåˆ¶è¿™ä¸ªè§†å›¾çš„å‡ºç°ã€éšè—åŠ¨ç”»éå¸¸æ–¹ä¾¿ã€‚ç„¶è€Œï¼Œæœ‰æ—¶å€™éœ€è¦é€‰æ‹©è½»é‡çº§çš„ UIView ç±»å‹æ¥å®ç°ã€‚è¿™æ—¶è¯¥æ€ä¹ˆå®šåˆ¶å®ƒçš„å‡ºç°ã€éšè—åŠ¨ç”»å‘¢ï¼Ÿè¿™é‡Œæä¾›ä¸€ä¸ªæ€è·¯ï¼šä½¿ç”¨ UIView çš„ `willMoveToSuperview:` å’Œ `didMoveToSuperview`è¿™ç»„æ–¹æ³•ï¼Œå®ƒä»¬ä¼šåœ¨ `UIView` ä½œä¸ºsubView è¢«æ·»åŠ åˆ°å…¶ä»– UIView ä¸­æ—¶è°ƒç”¨ã€‚è¿™é‡Œéœ€è¦æ³¨æ„ï¼Œè‡ªèº«è°ƒç”¨ `removeFromSuperview ` æ–¹æ³•æ—¶ï¼ŒåŒæ ·ä¼šè§¦å‘è¿™ç»„æ–¹æ³•ï¼Œåªä¸è¿‡è¿™æ—¶çš„å‚æ•°ä¼šæ˜¯ä¸€ä¸ª nilã€‚

æä¾›ä¸€ä¸ªä¾‹å­æ¥è¯´æ˜ï¼šä¸€ä¸ªé€‰æ‹© UIView ç±»å‹å®ç°çš„è‡ªå®šä¹‰ actionSheet çš„å‡ºå…¥åŠ¨ç”»ï¼Œäº¤äº’åŸºæœ¬å’Œå¾®ä¿¡ä¸€è‡´ã€‚

```objective-c
#pragma mark - show & dismiss
- (void)didMoveToSuperview {
if (self.superview) {
[UIView animateWithDuration:0.35 delay:0 usingSpringWithDamping:0.9 initialSpringVelocity:10 options:UIViewAnimationOptionCurveEaseIn animations:^{
_backgroundControl.alpha = 1;
self.actionSheetTable.frame = CGRectMake(0, SCREEN_HEIGHT - _sheetHeight, SCREEN_WIDTH, _sheetHeight);
} completion:^(BOOL finished) {
[super didMoveToSuperview];
}];
}
}

- (void)hideSelf {
[UIView animateWithDuration:0.35 delay:0 usingSpringWithDamping:0.9 initialSpringVelocity:10 options:UIViewAnimationOptionCurveEaseIn animations:^{
_backgroundControl.alpha = 0;
self.actionSheetTable.frame = CGRectMake(0, SCREEN_HEIGHT, SCREEN_WIDTH, _sheetHeight);
} completion:^(BOOL finished) {
[self removeFromSuperview];
}];
}
```


iOS å¦‚ä½•è°ƒè¯• WebView ï¼ˆäºŒï¼‰
--------
**ä½œè€…**: [Lefe_x](https://weibo.com/u/5953150140)

ä¸Šæ¬¡çš„å°é›†ä¸­ï¼Œæˆ‘ä¸»è¦è®¨è®ºäº†å¦‚ä½•è°ƒè¯• WebView ï¼Œå°é›†å‘å‡ºå  @æŠ˜è…¾èŒƒå„¿_å‘³ç²¾ æä¾›äº†å¦ä¸€ç§æ–¹æ³•æ¥è°ƒè¯• WebViewã€‚æˆ‘è§‰å¾—æœ‰å¿…è¦å†æ‰©å±•ä¸€ä¸‹ï¼ŒåŸè¯æ˜¯è¿™æ ·çš„ï¼š

> çœŸè¯´æ–¹ä¾¿è¿˜æ˜¯æ¤å…¥ä¸€ä¸ª webview console åœ¨ debug ç¯å¢ƒï¼Œå¯ä»¥åœ¨é»‘ç›’ä¸‹ä¸è¿ç”µè„‘ä¸è¿ safari è°ƒ domï¼Œè°ƒjsï¼Œå¦å¤–åœ¨å¼€å‘æœŸé—´ Xcode æ–­ç‚¹ run çš„æ—¶å€™ï¼Œjs hook console.log console.alertï¼Œæ¥ç®¡window.onerror å…¨éƒ½æ”¹ bridge NSLog è¾“å‡ºï¼Œä¹Ÿä¼šæ–¹ä¾¿ç‚¹ã€‚

çŸ­çŸ­å‡ å¥è¯ï¼Œä¿¡æ¯é‡å¾ˆå¤§ï¼Œç§ä¸‹å‘å‘³ç²¾å­¦ä¹ äº†ä¸‹ï¼Œè¿™é‡Œæ€»ç»“ä¸€ä¸‹ã€‚å†™å®Œè¿™ä¸ªå°é›†ç‰¹æ„è®©å‘³ç²¾çœ‹äº†ä¸‹ï¼Œè§‰å¾—æœ‰å¿…è¦å†è¡¥å……ä¸‹ç¬¬äºŒç§è°ƒè¯•æŠ€å·§ï¼Œä½†ä¸­é€”è¸©äº†å‡ ä¸ªå‘ï¼Œä¸€ç›´åˆ°23:30å·¦å³æ‰æå®šã€‚

ç¬¬ä¸€ï¼ŒæŠŠ WebView ç”¨æ¥è°ƒè¯•çš„ logã€alertã€error æ˜¾ç¤ºåˆ° NA ï¼Œåœ¨è°ƒè¯•æ—¶ä¼šæ–¹ä¾¿ä¸å°‘ã€‚åš WebView ä¸ç«¯äº¤äº’çš„æ—¶å€™ï¼Œä¸»è¦ç”¨ `window.webkit.messageHandlers.xxx.postMessage(params);` æ¥ç»™ç«¯å‘æ¶ˆæ¯ï¼Œä¹Ÿå°±æ˜¯è¯´ WebView æƒ³ç»™ç«¯å‘æ¶ˆæ¯çš„æ—¶å€™ç›´æ¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•å³å¯ï¼Œç«¯ä¼šé€šè¿‡ `WKScriptMessageHandler` çš„ä»£ç†æ–¹æ³•æ¥æ¥æ”¶æ¶ˆæ¯ï¼Œè€Œæ­¤æ—¶ç«¯æ ¹æ®å’Œ WebView çº¦å®šçš„è§„åˆ™è¿›è¡Œé€šä¿¡å³å¯ã€‚

```
- (void)userContentController:(WKUserContentController *)userContentController didReceiveScriptMessage:(WKScriptMessage *)message
```

è€Œæ·»åŠ è°ƒè¯•ä¿¡æ¯ï¼Œæ— éå°±æ˜¯ç»™ WebView æ·»åŠ äº† logã€alertã€error è¿™äº›æ¶ˆæ¯çš„ bridgeï¼Œè¿™æ ·å½“ WebView ç»™ç«¯å‘é€æ¶ˆæ¯åï¼Œç«¯æ ¹æ®å’Œ WebView çº¦å®šçš„è§„åˆ™è§£æ logã€alertã€error ä¸ºç«¯å¯¹åº”çš„äº‹ä»¶ï¼Œæ¯”å¦‚ log ç›´æ¥è°ƒç”¨ç«¯çš„ `NSLog`ï¼Œalert è°ƒç”¨ç«¯çš„ `UIAlertController`ã€‚

ç¬¬äºŒï¼Œé»‘ç›’ä¸‹è°ƒè¯• WebViewï¼Œæ— éœ€è¿æ¥ç”µè„‘å’Œ safari å³å¯è°ƒè¯• DOMï¼Œè¿™ä¸ªå¯ä»¥å‚è€ƒå°ç¨‹åºçš„ [vConsole](https://github.com/Tencent/vConsole) æˆ–è€… [eruda
](https://github.com/liriliri/eruda) ã€‚å¯ä»¥ç›´æ¥åœ¨ WebView ä¸­æ¥å…¥ï¼Œæˆ–è€…åœ¨ç«¯ä¸­æ¥å…¥ã€‚è¿™é‡Œä»¥åœ¨ç«¯ä¸­æ¥å…¥ eruda ä¸ºä¾‹ï¼Œè¿™é‡Œè¸©åˆ°å‡ ä¸ªå‘ï¼š

1.æœ‰äº›é¡µé¢æ˜¾ç¤ºä¸å‡ºæ¥ï¼Œä¼°è®¡æ˜¯æ•…æ„å±è”½æ‰çš„ï¼Œå‘³ç²¾ç‰¹æ„ä½¿ç”¨ JSBox è¯•äº†ä¸‹å…¶å®ƒé¡µé¢ï¼Œå‘ç°ç™¾åº¦ç­‰éƒ½ä¸å¯ä»¥æ˜¾ç¤ºè°ƒè¯•æŒ‰é’®ï¼Œè€Œæ˜é‡‘æ˜¯å¯ä»¥çš„ï¼›

2.ä½¿ç”¨æœ¬åœ°çš„é¡µé¢ä¹Ÿæ˜¾ç¤ºä¸å‡ºæ¥ï¼Œè¿™æ˜¯ webview è·¨åŸŸå®‰å…¨æ–¹é¢çš„è€ƒè™‘ï¼Œfile åè®®ä¸‹ä¼šç¦æ­¢ js css html ä»¥éƒ¨åˆ† fileï¼Œéƒ¨åˆ†ç½‘ç»œçš„æ–¹å¼åŠ è½½ã€‚

ä¸‹é¢è¿™æ®µä»£ç ç›´æ¥åœ¨ webview åŠ è½½å®Œæˆåæ‰§è¡Œå³å¯ã€‚

```
NSString *js = @"(function() {var script = document.createElement('script');script.type = 'text/javascript';script.src = 'https://xteko.blob.core.windows.net/neo/eruda-loader.js';document.body.appendChild(script);})();";
[self.webView evaluateJavaScript:js completionHandler: nil];
```


![](https://github.com/awesome-tips/iOS-Tips/blob/master/images/2018/05/14-1.jpg)


UIView çš„äº‹ä»¶é€ä¼ 
--------
**ä½œè€…**: [Vong_HUST](https://weibo.com/VongLo)

é€šå¸¸æˆ‘ä»¬ä¼šé‡åˆ°è¿™ç§éœ€æ±‚ï¼Œä¸€ä¸ªè§†å›¾é™¤äº†éœ€è¦å“åº”å­è§†å›¾çš„ç‚¹å‡»äº‹ä»¶ï¼Œå…¶å®ƒç©ºç™½åœ°æ–¹å¸Œæœ›èƒ½å°†ç‚¹å‡»äº‹ä»¶é€ä¼ åˆ°ï¼Œæ¯”å¦‚è‡ªå®šä¹‰äº†ä¸€ä¸ªâ€œå¯¼èˆªæ â€ï¼Œé™¤äº†å·¦å³ä¸¤è¾¹æŒ‰é’®ï¼Œå¸Œæœ›å…¶å®ƒéƒ¨åˆ†ç‚¹å‡»èƒ½å¤Ÿé€ä¼ åˆ°åº•ä¸‹çš„è§†å›¾ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥é€šè¿‡å¤å†™ hitTest æ–¹æ³•ï¼Œå…·ä½“å®ç°å¦‚ä¸‹ã€‚

```objc
@implementation PassthroughView

- (UIView *)hitTest:(CGPoint)point withEvent:(UIEvent *)event {
if (self.hidden || self.alpha < FLT_EPSILON || self.userInteractionEnabled) {
return [super hitTest:point withEvent:event];
}

UIView *targetView = nil;
for (UIView *subview in [[self subviews] reverseObjectEnumerator]) {
if ((targetView = [subview hitTest:[subview convertPoint:point fromView:self] withEvent:event])) {
break;
}
}

return targetView;
}

@end
```
ä»¥ä¸Šä»£ç å³å¯å®ç°ï¼Œåªå“åº”å­è§†å›¾çš„äº‹ä»¶ï¼Œè€Œéå­è§†å›¾åŒºåŸŸéƒ¨åˆ†çš„äº¤äº’äº‹ä»¶åˆ™é€ä¼ åˆ°å“åº”é“¾ä¸­çš„ä¸‹ä¸€ä¸ªå“åº”è€…ã€‚
å¦‚æœä½ æœ‰å…¶å®ƒæ›´å¥½æ–¹å¼ï¼Œä¹Ÿå¯ä»¥åˆ†äº«å‡ºæ¥ï¼Œä¸€èµ·äº¤æµä¸‹


ä¸€ä¸ªç»“æ„è¾ƒä¸ºåˆç†çš„ä¸‹è½½æ¨¡å—è¯¥æ€ä¹ˆè®¾è®¡
--------
**ä½œè€…**: [halohily](https://weibo.com/halohily)

æœ€è¿‘è´Ÿè´£ä¸‹è½½ç»„ä»¶çš„å¼€å‘ï¼Œå¯¹äºå¦‚ä½•è®¾è®¡ä¸€ä¸ªä¸‹è½½æ¨¡å—æœ‰ä¸€äº›ç²—æµ…ä½“ä¼šï¼Œä»Šå¤©åˆ†äº«ä¸€ä¸‹æˆ‘é‡‡ç”¨çš„æ–¹æ¡ˆï¼Œå¸Œæœ›èƒ½å¤ŸæŠ›ç –å¼•ç‰ã€‚å¦å¤–ï¼Œæœ€è¿‘ä¼šå‡ºä¸¤ç¯‡ä¸»é¢˜ä¸ºâ€œä¸‹è½½ç»„ä»¶çš„è®¾è®¡â€å’Œâ€œä¸ Hybrid ç›¸å…³çš„ä¸‹è½½æ–¹æ¡ˆâ€çš„é•¿æ–‡ï¼Œæ¬¢è¿å…³æ³¨#çŸ¥è¯†å°é›†#ã€‚

â€œä¸‹è½½â€ä½œä¸ºä¸€ä¸ªéœ€è¦æœ¬åœ°ç»“æ„åŒ–ã€æŒä¹…åŒ–å­˜å‚¨çš„åœºæ™¯ï¼Œä½¿ç”¨æ•°æ®åº“æ˜¯æ¯”è¾ƒè‡ªç„¶çš„é€‰æ‹©ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬é¦–å…ˆæ‹†åˆ†å‡ºä¸€ä¸ªæ•°æ®åº“æ¨¡å—ï¼Œç”¨æ¥å­˜å‚¨ä¸‹è½½è®°å½•ã€‚ä¸»è¦å­—æ®µä¸ºä¸‹è½½ä»»åŠ¡çš„ä¿¡æ¯ï¼Œå¦‚ urlã€æ–‡ä»¶å¤§å°ã€æ—¶é—´æˆ³ç­‰ï¼Œä»¥åŠæœ€é‡è¦çš„æ–‡ä»¶æœ¬åœ°å­˜å‚¨è·¯å¾„ã€‚è¿™ä¸€å±‚å¯ä»¥åœ¨æ¥å£è®¾è®¡ä¸Šè®¤çœŸæ€è™‘ï¼Œæ¯”å¦‚ä»…æ¶‰åŠå½“å‰ä¸šåŠ¡é€»è¾‘ï¼Œè€Œä¸æ¶‰åŠå…·ä½“çš„æ•°æ®åº“æ“ä½œï¼Œç›¸å½“äºæ˜¯è¾ƒFMDBç­‰æ•°æ®åº“ç»„ä»¶æ¥è¯´æ›´é«˜å±‚çš„æŠ½è±¡ã€‚åæœŸéœ€è¦æ›´æ¢åº•å±‚æ•°æ®åº“å¼•æ“æ—¶ï¼Œæœ¬å±‚å°è£…æ— éœ€æ”¹åŠ¨ï¼Œæ˜¯æ¯”è¾ƒç†æƒ³çš„å®ç°ã€‚

æ•°æ®åº“æ˜¯ç”¨æ¥å­˜å‚¨ä¸‹è½½è®°å½•çš„ï¼Œé‚£ä¹ˆæ‰€ä¸‹è½½çš„å…·ä½“æ–‡ä»¶å‘¢ï¼Ÿè‡ªç„¶å°±éœ€è¦ä¸€ä¸ªæ–‡ä»¶ç®¡ç†æ¨¡å—ï¼Œåœ¨è¿™ä¸ªæ¨¡å—é‡Œï¼Œè´Ÿè´£æ ¹æ®æ–‡ä»¶ url ç”Ÿæˆæœ¬åœ°çš„å­˜å‚¨è·¯å¾„ï¼Œä»¥åŠè¿›è¡Œæ–‡ä»¶æ ¡éªŒã€å­˜å‚¨ã€ç§»é™¤ç­‰æ“ä½œã€‚

æ‰€è¦ä¸‹è½½çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰ä½“ç§¯ã€ç±»å‹ç­‰è¿›è¡ŒåŒºåˆ†ã€‚å¯¹äºç½‘ç»œè¯·æ±‚çš„ç»“æœè¿™ç±»ç®€çŸ­å†…å®¹ï¼Œæˆ‘æŠ½è±¡å‡ºäº†ä¸€ä¸ªç¼“å­˜ç®¡ç†å™¨ï¼Œç”¨æ¥å®Œæˆç½‘ç»œè¯·æ±‚ã€å›¾ç‰‡ç­‰å†…å®¹çš„ç¼“å­˜ã€‚ç½‘ç»œè¯·æ±‚çš„ç»“æœï¼Œå¯ä»¥é€‰æ‹© YYCacheã€EGOCacheç­‰ç¼“å­˜æ¡†æ¶ã€‚è€Œå›¾ç‰‡çš„ç¼“å­˜ï¼Œåˆ™å¯ä»¥é€‰æ‹©ä¸“æ³¨å›¾ç‰‡ç¼“å­˜çš„YYWebImageã€SDWebImageç­‰æ¡†æ¶ã€‚

å¯¹äºä½“ç§¯è¾ƒå¤§çš„æ–‡ä»¶ï¼Œè‡ªç„¶éœ€è¦ä¸€ä¸ªä¸“æ³¨å¤§æ–‡ä»¶ä¸‹è½½çš„æ¨¡å—ã€‚è¿™ä¸ªæ¨¡å—ä¸å…³æ³¨å…·ä½“çš„æ–‡ä»¶ç±»å‹ï¼Œä¸å…³æ³¨å…·ä½“çš„ä¸šåŠ¡åœºæ™¯ï¼Œå®ƒåªéœ€è¦æ–‡ä»¶urlã€æ–‡ä»¶ç®¡ç†æ¨¡å—ç”Ÿæˆçš„æœ¬åœ°ç›®æ ‡è·¯å¾„ï¼Œå®Œæˆä¸‹è½½ä»»åŠ¡å³å¯ã€‚

åœ¨ä»¥ä¸Šé€šç”¨æ¨¡å—çš„åŸºç¡€ä¸Šï¼Œæœ‰ä¸€ä¸ªä¸šåŠ¡å±‚çš„å°è£…ï¼Œå®ƒè´Ÿè´£æ ¹æ®æäº¤çš„ä¸‹è½½ä»»åŠ¡ï¼Œåè°ƒè°ƒç”¨å„åŸºç¡€ç»„ä»¶ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä¸€ä¸ªä¸‹è½½ä»»åŠ¡åŒ…æ‹¬ä¸€ä¸ªè§†é¢‘æ–‡ä»¶ã€ä¸€ä¸ªç½‘ç»œè¯·æ±‚ç»“æœã€ä¸‰å¼ å›¾ç‰‡ã€‚æœ¬æ¨¡å—åœ¨æ”¶åˆ°ä»»åŠ¡åï¼Œé¦–å…ˆè§£æå‡ºä»¥ä¸Šçš„ä»»åŠ¡å…·ä½“ç»“æ„ã€‚ä½¿ç”¨æ–‡ä»¶ç®¡ç†æ¨¡å—ï¼Œæ ¹æ®è§†é¢‘æ–‡ä»¶ url ç”Ÿæˆæœ¬åœ°å­˜å‚¨ç›®æ ‡è·¯å¾„ï¼Œè°ƒç”¨å¤§æ–‡ä»¶ä¸‹è½½å™¨å®Œæˆä¸‹è½½ï¼Œæ­¤ä¸ºä¸€ä¸ªå­ä»»åŠ¡ã€‚å¯¹äºç½‘ç»œè¯·æ±‚ç»“æœï¼Œè°ƒç”¨ç¼“å­˜æ¨¡å—ï¼Œè¿›è¡Œç¼“å­˜ï¼Œæ­¤ä¸ºä¸€ä¸ªå­ä»»åŠ¡ã€‚å¯¹äºä¸‰å¼ å›¾ç‰‡ï¼Œä½¿ç”¨å›¾ç‰‡ç¼“å­˜å™¨å®Œæˆç¼“å­˜ï¼Œæ­¤ä¸ºä¸€ä¸ªå­ä»»åŠ¡ã€‚ä¸‰ä¸ªå­ä»»åŠ¡å‡å®Œæˆï¼Œä½¿ç”¨æ•°æ®åº“æ¨¡å—ï¼Œå¯¹ä¸‹è½½è®°å½•ã€åª’ä½“æ–‡ä»¶è®°å½•ç­‰è¿›è¡Œå­˜å‚¨ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæœ¬æ¨¡å—è¿˜è´Ÿè´£å¯¹å¤–æä¾›ä¸‹è½½ä¸­ä»»åŠ¡ã€å·²ä¸‹è½½ä»»åŠ¡ç­‰æ•°æ®ã€‚

å› ç¯‡å¹…æœ‰é™ï¼Œå…·ä½“çš„ç»†èŠ‚è¯·å…³æ³¨åç»­é•¿æ–‡ã€‚
